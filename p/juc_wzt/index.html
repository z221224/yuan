<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="JUCæ¦‚è¿°\rä»€ä¹ˆæ˜¯JUCï¼Ÿ\rjava.util.concurrentåŒ…ä¸­æä¾›çš„å¹¶å‘ç¼–ç¨‹çš„å·¥å…·ç±»\nå®ƒæä¾›å¤šç§å·¥å…·ç±»ï¼šåŸå­ç±»ï¼Œçº¿ç¨‹æ± ï¼Œå¹¶å‘é›†åˆï¼ŒåŒæ­¥å™¨\nè¿›ç¨‹ä¸çº¿ç¨‹ï¼š\rè¿›ç¨‹ï¼šå…·å¤‡ç‹¬ç«‹åŠŸèƒ½çš„ç¨‹åºè½¯ä»¶å…³äºæŸä¸ªæ•°æ®é›†åˆçš„ä¾æ¬¡è¿è¡Œæ´»åŠ¨\næ“ä½œç³»ç»ŸåŠ¨æ€æ‰§è¡Œçš„åŸºæœ¬å•ä½\nçº¿ç¨‹ï¼šä¸€ä¸ªè¿›ç¨‹åŒ…å«ä¸€ä¸ªæˆ–è€…å¤šä¸ªçº¿ç¨‹\nç‹¬ç«‹è¿è¡Œå’Œè°ƒåº¦çš„åŸºæœ¬å•ä½\nå¹¶è¡Œå’Œå¹¶å‘ï¼š\rå¹¶è¡Œï¼šå¤šä¸ªçº¿ç¨‹åŒæ—¶è·‘ï¼Œå¹²ä¸åŒçš„äº‹\nå¹¶å‘ï¼šå¤šä¸ªçº¿ç¨‹å¯¹åŒä¸€èµ„æºçš„æŠ¢å \nåŒæ­¥å’Œå¼‚æ­¥ï¼š\råŒæ­¥ï¼šä»»åŠ¡æŒ‰é¡ºåºä¾æ¬¡æ‰§è¡Œï¼Œæ¯ä¸€ä¸ªä»»åŠ¡å¿…é¡»ç­‰å¾…å‰ä¸€ä¸ªä»»åŠ¡å®Œæˆ\nå¼‚æ­¥ï¼šåŒæ—¶å‘èµ·è¯·æ±‚ï¼Œä¸éœ€è¦ç­‰å¾…ç»“æœï¼Œç»“æœå›æ¥å\nçº¿ç¨‹çš„çŠ¶æ€ï¼š\ræ–°å»ºï¼ˆNewï¼‰ï¼šçº¿ç¨‹è¢«åˆ›å»ºä½†å°šæœªå¯åŠ¨æ‰§è¡Œã€‚ å°±ç»ªï¼ˆRunnableï¼‰ï¼šçº¿ç¨‹ç­‰å¾…CPUæ—¶é—´ç‰‡ä»¥ä¾¿æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯å¤„äºå°±ç»ªçŠ¶æ€ã€‚ é˜»å¡ï¼ˆBlockedï¼‰ï¼šçº¿ç¨‹æš‚åœæ‰§è¡Œï¼Œé€šå¸¸æ˜¯å› ä¸ºç­‰å¾…æŸäº›æ¡ä»¶æ»¡è¶³ï¼Œä¾‹å¦‚ç­‰å¾…I/Oæ“ä½œå®Œæˆã€ç­‰å¾…é”é‡Šæ”¾ç­‰ã€‚ æ— é™æœŸç­‰å¾…ï¼ˆWaitingï¼‰ï¼šçº¿ç¨‹æ— é™æœŸåœ°ç­‰å¾…æŸä¸ªæ¡ä»¶çš„å‘ç”Ÿï¼Œé€šå¸¸éœ€è¦å…¶ä»–çº¿ç¨‹æ¥å”¤é†’å®ƒã€‚ æœ‰é™æœŸç­‰å¾…ï¼ˆTimed Waitingï¼‰ï¼šçº¿ç¨‹ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œè¶…è¿‡æŒ‡å®šæ—¶é—´åä¼šè‡ªåŠ¨å”¤é†’ã€‚ ç»ˆæ­¢ï¼ˆTerminatedï¼‰ï¼šçº¿ç¨‹æ‰§è¡Œå®Œæˆæˆ–è€…å¼‚å¸¸ç»ˆæ­¢ï¼Œè¿›å…¥ç»ˆæ­¢çŠ¶æ€ã€‚ æšä¸¾æ²¡èµ‹å€¼ä¼šç»™å®ƒèµ‹åˆå€¼ï¼Œä»0å¼€å§‹ç´¯åŠ \nwaitå’Œsleep\råŒºåˆ«ï¼š\nwaitéœ€è¦ notify()æˆ–notifyAll()æ–¹æ³•æ¥å”¤é†’ å¿…é¡»åœ¨é”ç¯å¢ƒä¸‹ä½¿ç”¨\nsleepæ˜¯å½“å‰çº¿ç¨‹æš‚åœæ‰§è¡ŒæŒ‡å®šæ—¶é—´ï¼Œæ—¶é—´åˆ°å”¤é†’\nåˆ›å»ºçº¿ç¨‹ï¼š\råˆ›å»ºçº¿ç¨‹å¸¸ç”¨çš„ä¸¤ç§æ–¹å¼ï¼š\n1 2 3 4 1. ç»§æ‰¿Threadï¼šjavaæ˜¯å•ç»§æ‰¿ï¼Œèµ„æºå®è´µï¼Œè¦ç”¨æ¥å£æ–¹å¼ extends Thread 2. å®ç°Runableæ¥å£ implements Runnable 3. implements Callable 4. ThreadPoolExecutor *********************************************************************************************è§†é¢‘ç»†èŠ‚éœ€è¦è¡¥å……\nç»§æ‰¿ThreadæŠ½è±¡ç±»ï¼š\r1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 class T1 extends Thread{ @Override public void run() { System.out.println(&#34;Thread....&#34;); super.run(); } } public class ThreadDemo { public static void main(String[] args) { T1 t1 = new T1(); t1.start(); } } å®ç°Runableæ¥å£:\ræ–°å»ºç±»å®ç°runnableæ¥å£ï¼šè¿™ç§æ–¹æ³•ä¼šæ–°å¢ç±»ï¼Œæœ‰æ›´å¥½çš„æ–¹æ³•\n">
<title>juc_wzt</title>

<link rel='canonical' href='https://z221224.github.io/yuan/p/juc_wzt/'>

<link rel="stylesheet" href="/yuan/scss/style.min.b9c8156d464c343bdacaf14a871581fb94cbbdb9dd5cbce4ba017361187cc930.css"><meta property='og:title' content="juc_wzt">
<meta property='og:description' content="JUCæ¦‚è¿°\rä»€ä¹ˆæ˜¯JUCï¼Ÿ\rjava.util.concurrentåŒ…ä¸­æä¾›çš„å¹¶å‘ç¼–ç¨‹çš„å·¥å…·ç±»\nå®ƒæä¾›å¤šç§å·¥å…·ç±»ï¼šåŸå­ç±»ï¼Œçº¿ç¨‹æ± ï¼Œå¹¶å‘é›†åˆï¼ŒåŒæ­¥å™¨\nè¿›ç¨‹ä¸çº¿ç¨‹ï¼š\rè¿›ç¨‹ï¼šå…·å¤‡ç‹¬ç«‹åŠŸèƒ½çš„ç¨‹åºè½¯ä»¶å…³äºæŸä¸ªæ•°æ®é›†åˆçš„ä¾æ¬¡è¿è¡Œæ´»åŠ¨\næ“ä½œç³»ç»ŸåŠ¨æ€æ‰§è¡Œçš„åŸºæœ¬å•ä½\nçº¿ç¨‹ï¼šä¸€ä¸ªè¿›ç¨‹åŒ…å«ä¸€ä¸ªæˆ–è€…å¤šä¸ªçº¿ç¨‹\nç‹¬ç«‹è¿è¡Œå’Œè°ƒåº¦çš„åŸºæœ¬å•ä½\nå¹¶è¡Œå’Œå¹¶å‘ï¼š\rå¹¶è¡Œï¼šå¤šä¸ªçº¿ç¨‹åŒæ—¶è·‘ï¼Œå¹²ä¸åŒçš„äº‹\nå¹¶å‘ï¼šå¤šä¸ªçº¿ç¨‹å¯¹åŒä¸€èµ„æºçš„æŠ¢å \nåŒæ­¥å’Œå¼‚æ­¥ï¼š\råŒæ­¥ï¼šä»»åŠ¡æŒ‰é¡ºåºä¾æ¬¡æ‰§è¡Œï¼Œæ¯ä¸€ä¸ªä»»åŠ¡å¿…é¡»ç­‰å¾…å‰ä¸€ä¸ªä»»åŠ¡å®Œæˆ\nå¼‚æ­¥ï¼šåŒæ—¶å‘èµ·è¯·æ±‚ï¼Œä¸éœ€è¦ç­‰å¾…ç»“æœï¼Œç»“æœå›æ¥å\nçº¿ç¨‹çš„çŠ¶æ€ï¼š\ræ–°å»ºï¼ˆNewï¼‰ï¼šçº¿ç¨‹è¢«åˆ›å»ºä½†å°šæœªå¯åŠ¨æ‰§è¡Œã€‚ å°±ç»ªï¼ˆRunnableï¼‰ï¼šçº¿ç¨‹ç­‰å¾…CPUæ—¶é—´ç‰‡ä»¥ä¾¿æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯å¤„äºå°±ç»ªçŠ¶æ€ã€‚ é˜»å¡ï¼ˆBlockedï¼‰ï¼šçº¿ç¨‹æš‚åœæ‰§è¡Œï¼Œé€šå¸¸æ˜¯å› ä¸ºç­‰å¾…æŸäº›æ¡ä»¶æ»¡è¶³ï¼Œä¾‹å¦‚ç­‰å¾…I/Oæ“ä½œå®Œæˆã€ç­‰å¾…é”é‡Šæ”¾ç­‰ã€‚ æ— é™æœŸç­‰å¾…ï¼ˆWaitingï¼‰ï¼šçº¿ç¨‹æ— é™æœŸåœ°ç­‰å¾…æŸä¸ªæ¡ä»¶çš„å‘ç”Ÿï¼Œé€šå¸¸éœ€è¦å…¶ä»–çº¿ç¨‹æ¥å”¤é†’å®ƒã€‚ æœ‰é™æœŸç­‰å¾…ï¼ˆTimed Waitingï¼‰ï¼šçº¿ç¨‹ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œè¶…è¿‡æŒ‡å®šæ—¶é—´åä¼šè‡ªåŠ¨å”¤é†’ã€‚ ç»ˆæ­¢ï¼ˆTerminatedï¼‰ï¼šçº¿ç¨‹æ‰§è¡Œå®Œæˆæˆ–è€…å¼‚å¸¸ç»ˆæ­¢ï¼Œè¿›å…¥ç»ˆæ­¢çŠ¶æ€ã€‚ æšä¸¾æ²¡èµ‹å€¼ä¼šç»™å®ƒèµ‹åˆå€¼ï¼Œä»0å¼€å§‹ç´¯åŠ \nwaitå’Œsleep\råŒºåˆ«ï¼š\nwaitéœ€è¦ notify()æˆ–notifyAll()æ–¹æ³•æ¥å”¤é†’ å¿…é¡»åœ¨é”ç¯å¢ƒä¸‹ä½¿ç”¨\nsleepæ˜¯å½“å‰çº¿ç¨‹æš‚åœæ‰§è¡ŒæŒ‡å®šæ—¶é—´ï¼Œæ—¶é—´åˆ°å”¤é†’\nåˆ›å»ºçº¿ç¨‹ï¼š\råˆ›å»ºçº¿ç¨‹å¸¸ç”¨çš„ä¸¤ç§æ–¹å¼ï¼š\n1 2 3 4 1. ç»§æ‰¿Threadï¼šjavaæ˜¯å•ç»§æ‰¿ï¼Œèµ„æºå®è´µï¼Œè¦ç”¨æ¥å£æ–¹å¼ extends Thread 2. å®ç°Runableæ¥å£ implements Runnable 3. implements Callable 4. ThreadPoolExecutor *********************************************************************************************è§†é¢‘ç»†èŠ‚éœ€è¦è¡¥å……\nç»§æ‰¿ThreadæŠ½è±¡ç±»ï¼š\r1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 class T1 extends Thread{ @Override public void run() { System.out.println(&#34;Thread....&#34;); super.run(); } } public class ThreadDemo { public static void main(String[] args) { T1 t1 = new T1(); t1.start(); } } å®ç°Runableæ¥å£:\ræ–°å»ºç±»å®ç°runnableæ¥å£ï¼šè¿™ç§æ–¹æ³•ä¼šæ–°å¢ç±»ï¼Œæœ‰æ›´å¥½çš„æ–¹æ³•\n">
<meta property='og:url' content='https://z221224.github.io/yuan/p/juc_wzt/'>
<meta property='og:site_name' content='ç±³ ç²’'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2025-01-09T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2025-01-09T00:00:00&#43;00:00'/>
<meta name="twitter:title" content="juc_wzt">
<meta name="twitter:description" content="JUCæ¦‚è¿°\rä»€ä¹ˆæ˜¯JUCï¼Ÿ\rjava.util.concurrentåŒ…ä¸­æä¾›çš„å¹¶å‘ç¼–ç¨‹çš„å·¥å…·ç±»\nå®ƒæä¾›å¤šç§å·¥å…·ç±»ï¼šåŸå­ç±»ï¼Œçº¿ç¨‹æ± ï¼Œå¹¶å‘é›†åˆï¼ŒåŒæ­¥å™¨\nè¿›ç¨‹ä¸çº¿ç¨‹ï¼š\rè¿›ç¨‹ï¼šå…·å¤‡ç‹¬ç«‹åŠŸèƒ½çš„ç¨‹åºè½¯ä»¶å…³äºæŸä¸ªæ•°æ®é›†åˆçš„ä¾æ¬¡è¿è¡Œæ´»åŠ¨\næ“ä½œç³»ç»ŸåŠ¨æ€æ‰§è¡Œçš„åŸºæœ¬å•ä½\nçº¿ç¨‹ï¼šä¸€ä¸ªè¿›ç¨‹åŒ…å«ä¸€ä¸ªæˆ–è€…å¤šä¸ªçº¿ç¨‹\nç‹¬ç«‹è¿è¡Œå’Œè°ƒåº¦çš„åŸºæœ¬å•ä½\nå¹¶è¡Œå’Œå¹¶å‘ï¼š\rå¹¶è¡Œï¼šå¤šä¸ªçº¿ç¨‹åŒæ—¶è·‘ï¼Œå¹²ä¸åŒçš„äº‹\nå¹¶å‘ï¼šå¤šä¸ªçº¿ç¨‹å¯¹åŒä¸€èµ„æºçš„æŠ¢å \nåŒæ­¥å’Œå¼‚æ­¥ï¼š\råŒæ­¥ï¼šä»»åŠ¡æŒ‰é¡ºåºä¾æ¬¡æ‰§è¡Œï¼Œæ¯ä¸€ä¸ªä»»åŠ¡å¿…é¡»ç­‰å¾…å‰ä¸€ä¸ªä»»åŠ¡å®Œæˆ\nå¼‚æ­¥ï¼šåŒæ—¶å‘èµ·è¯·æ±‚ï¼Œä¸éœ€è¦ç­‰å¾…ç»“æœï¼Œç»“æœå›æ¥å\nçº¿ç¨‹çš„çŠ¶æ€ï¼š\ræ–°å»ºï¼ˆNewï¼‰ï¼šçº¿ç¨‹è¢«åˆ›å»ºä½†å°šæœªå¯åŠ¨æ‰§è¡Œã€‚ å°±ç»ªï¼ˆRunnableï¼‰ï¼šçº¿ç¨‹ç­‰å¾…CPUæ—¶é—´ç‰‡ä»¥ä¾¿æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯å¤„äºå°±ç»ªçŠ¶æ€ã€‚ é˜»å¡ï¼ˆBlockedï¼‰ï¼šçº¿ç¨‹æš‚åœæ‰§è¡Œï¼Œé€šå¸¸æ˜¯å› ä¸ºç­‰å¾…æŸäº›æ¡ä»¶æ»¡è¶³ï¼Œä¾‹å¦‚ç­‰å¾…I/Oæ“ä½œå®Œæˆã€ç­‰å¾…é”é‡Šæ”¾ç­‰ã€‚ æ— é™æœŸç­‰å¾…ï¼ˆWaitingï¼‰ï¼šçº¿ç¨‹æ— é™æœŸåœ°ç­‰å¾…æŸä¸ªæ¡ä»¶çš„å‘ç”Ÿï¼Œé€šå¸¸éœ€è¦å…¶ä»–çº¿ç¨‹æ¥å”¤é†’å®ƒã€‚ æœ‰é™æœŸç­‰å¾…ï¼ˆTimed Waitingï¼‰ï¼šçº¿ç¨‹ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œè¶…è¿‡æŒ‡å®šæ—¶é—´åä¼šè‡ªåŠ¨å”¤é†’ã€‚ ç»ˆæ­¢ï¼ˆTerminatedï¼‰ï¼šçº¿ç¨‹æ‰§è¡Œå®Œæˆæˆ–è€…å¼‚å¸¸ç»ˆæ­¢ï¼Œè¿›å…¥ç»ˆæ­¢çŠ¶æ€ã€‚ æšä¸¾æ²¡èµ‹å€¼ä¼šç»™å®ƒèµ‹åˆå€¼ï¼Œä»0å¼€å§‹ç´¯åŠ \nwaitå’Œsleep\råŒºåˆ«ï¼š\nwaitéœ€è¦ notify()æˆ–notifyAll()æ–¹æ³•æ¥å”¤é†’ å¿…é¡»åœ¨é”ç¯å¢ƒä¸‹ä½¿ç”¨\nsleepæ˜¯å½“å‰çº¿ç¨‹æš‚åœæ‰§è¡ŒæŒ‡å®šæ—¶é—´ï¼Œæ—¶é—´åˆ°å”¤é†’\nåˆ›å»ºçº¿ç¨‹ï¼š\råˆ›å»ºçº¿ç¨‹å¸¸ç”¨çš„ä¸¤ç§æ–¹å¼ï¼š\n1 2 3 4 1. ç»§æ‰¿Threadï¼šjavaæ˜¯å•ç»§æ‰¿ï¼Œèµ„æºå®è´µï¼Œè¦ç”¨æ¥å£æ–¹å¼ extends Thread 2. å®ç°Runableæ¥å£ implements Runnable 3. implements Callable 4. ThreadPoolExecutor *********************************************************************************************è§†é¢‘ç»†èŠ‚éœ€è¦è¡¥å……\nç»§æ‰¿ThreadæŠ½è±¡ç±»ï¼š\r1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 class T1 extends Thread{ @Override public void run() { System.out.println(&#34;Thread....&#34;); super.run(); } } public class ThreadDemo { public static void main(String[] args) { T1 t1 = new T1(); t1.start(); } } å®ç°Runableæ¥å£:\ræ–°å»ºç±»å®ç°runnableæ¥å£ï¼šè¿™ç§æ–¹æ³•ä¼šæ–°å¢ç±»ï¼Œæœ‰æ›´å¥½çš„æ–¹æ³•\n">
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="åˆ‡æ¢èœå•">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/yuan/">
                
                    
                    
                    
                        
                        <img src="/yuan/img/avatar_hu13739649187745961479.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ğŸ•¸ï¸</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/yuan">ç±³ ç²’</a></h1>
            <h2 class="site-description">ä½ æ„Ÿåˆ°ç—›è‹¦ï¼Œæ˜¯å› ä¸ºä½ åœ¨æˆé•¿</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://www.bilibili.com/'
                        target="_blank"
                        title="bilibili"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://github.com/z221224'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/yuan/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>ä¸»é¡µ</span>
            </a>
        </li>
        
        
        <li >
            <a href='/yuan/%E5%85%B3%E4%BA%8E/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>å…³äº</span>
            </a>
        </li>
        
        
        <li >
            <a href='/yuan/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>å½’æ¡£</span>
            </a>
        </li>
        
        
        <li >
            <a href='/yuan/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>æœç´¢</span>
            </a>
        </li>
        
        
        <li >
            <a href='/yuan/%E9%93%BE%E6%8E%A5/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>é“¾æ¥</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>æš—è‰²æ¨¡å¼</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ç›®å½•</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#jucæ¦‚è¿°">JUCæ¦‚è¿°</a>
      <ol>
        <li><a href="#ä»€ä¹ˆæ˜¯juc">ä»€ä¹ˆæ˜¯JUCï¼Ÿ</a></li>
        <li><a href="#è¿›ç¨‹ä¸çº¿ç¨‹">è¿›ç¨‹ä¸çº¿ç¨‹ï¼š</a></li>
        <li><a href="#å¹¶è¡Œå’Œå¹¶å‘">å¹¶è¡Œå’Œå¹¶å‘ï¼š</a></li>
        <li><a href="#åŒæ­¥å’Œå¼‚æ­¥">åŒæ­¥å’Œå¼‚æ­¥ï¼š</a></li>
        <li><a href="#çº¿ç¨‹çš„çŠ¶æ€">çº¿ç¨‹çš„çŠ¶æ€ï¼š</a></li>
        <li><a href="#waitå’Œsleep">waitå’Œsleep</a></li>
        <li><a href="#åˆ›å»ºçº¿ç¨‹">åˆ›å»ºçº¿ç¨‹ï¼š</a>
          <ol>
            <li><a href="#ç»§æ‰¿threadæŠ½è±¡ç±»">ç»§æ‰¿ThreadæŠ½è±¡ç±»ï¼š</a></li>
            <li><a href="#å®ç°runableæ¥å£">å®ç°Runableæ¥å£:</a></li>
          </ol>
        </li>
        <li><a href="#synchronized">synchronized</a></li>
        <li><a href="#synchronizedçš„8é”é—®é¢˜">synchronizedçš„8é”é—®é¢˜</a></li>
      </ol>
    </li>
    <li><a href="#locké”">Locké”:</a>
      <ol>
        <li><a href="#reentrantlockå¯é‡å…¥é”">ReentrantLockå¯é‡å…¥é”</a></li>
        <li><a href="#å…¬å¹³é”">å…¬å¹³é”</a></li>
        <li><a href="#é™æ—¶ç­‰å¾…">é™æ—¶ç­‰å¾…</a></li>
        <li><a href="#reentrantlockå’ŒsynchronizedåŒºåˆ«">ReentrantLockå’ŒsynchronizedåŒºåˆ«</a></li>
        <li><a href="#reentrantreadwritelockè¯»å†™é”">ReentrantReadWriteLockè¯»å†™é”</a></li>
        <li><a href="#é”é™çº§">é”é™çº§</a></li>
        <li><a href="#è¯»å†™é”æ€»ç»“">è¯»å†™é”æ€»ç»“</a></li>
      </ol>
    </li>
    <li><a href="#çº¿ç¨‹é—´é€šä¿¡">çº¿ç¨‹é—´é€šä¿¡</a>
      <ol>
        <li><a href="#å¤šçº¿ç¨‹ç¼–ç¨‹æ¨¡æ¿ä¸­">å¤šçº¿ç¨‹ç¼–ç¨‹æ¨¡æ¿(ä¸­)</a></li>
        <li><a href="#è™šå‡å”¤é†’">è™šå‡å”¤é†’</a></li>
        <li><a href="#çº¿ç¨‹é€šä¿¡condition">çº¿ç¨‹é€šä¿¡ï¼ˆConditionï¼‰</a></li>
        <li><a href="#å®šåˆ¶åŒ–è°ƒç”¨é€šä¿¡">å®šåˆ¶åŒ–è°ƒç”¨é€šä¿¡</a></li>
      </ol>
    </li>
    <li><a href="#å¹¶å‘å®¹å™¨ç±»">å¹¶å‘å®¹å™¨ç±»</a>
      <ol>
        <li><a href="#copyonwrite"><strong>CopyOnWrite</strong></a>
          <ol>
            <li><a href="#ä»€ä¹ˆæ˜¯copyonwriteå®¹å™¨">ä»€ä¹ˆæ˜¯CopyOnWriteå®¹å™¨</a></li>
          </ol>
        </li>
        <li><a href="#åº”ç”¨åœºæ™¯">åº”ç”¨åœºæ™¯ï¼š</a></li>
        <li><a href="#ç¼ºç‚¹">ç¼ºç‚¹</a></li>
        <li><a href="#concurrenthashmap">ConcurrentHashMap</a></li>
      </ol>
    </li>
    <li><a href="#jucå¼ºå¤§çš„è¾…åŠ©ç±»">JUCå¼ºå¤§çš„è¾…åŠ©ç±»</a>
      <ol>
        <li><a href="#countdownlatch">CountDownLatch</a></li>
        <li><a href="#countdownlatch-ä¸-join-æ–¹æ³•çš„åŒºåˆ«">CountDownLatch ä¸ join æ–¹æ³•çš„åŒºåˆ«</a></li>
        <li><a href="#cyclicbarrier">CyclicBarrier</a></li>
        <li><a href="#cyclicbarrierå’Œcountdownlatchçš„åŒºåˆ«">CyclicBarrierå’ŒCountDownLatchçš„åŒºåˆ«</a></li>
        <li><a href="#semaphore">Semaphore</a></li>
      </ol>
    </li>
    <li><a href="#callableæ¥å£">Callableæ¥å£</a>
      <ol>
        <li><a href="#callableå’Œrunnableå¯¹æ¯”">Callableå’ŒRunnableå¯¹æ¯”</a></li>
        <li><a href="#callableçš„ä½¿ç”¨">Callableçš„ä½¿ç”¨</a></li>
        <li><a href="#futuretask">FutureTask</a></li>
        <li><a href="#callableæ¥å£ä¸runnableæ¥å£çš„åŒºåˆ«">callableæ¥å£ä¸runnableæ¥å£çš„åŒºåˆ«ï¼Ÿ</a></li>
      </ol>
    </li>
    <li><a href="#è·å–å¤šçº¿ç¨‹çš„æ–¹æ³•">è·å–å¤šçº¿ç¨‹çš„æ–¹æ³•</a></li>
    <li><a href="#é˜»å¡é˜Ÿåˆ—blockingqueue">é˜»å¡é˜Ÿåˆ—ï¼ˆBlockingQueueï¼‰</a>
      <ol>
        <li><a href="#ä»€ä¹ˆæ˜¯blockingqueue">ä»€ä¹ˆæ˜¯BlockingQueue</a></li>
        <li><a href="#blockingqueueæ¥å£">BlockingQueueæ¥å£</a></li>
        <li><a href="#æŠ›å‡ºå¼‚å¸¸">æŠ›å‡ºå¼‚å¸¸</a></li>
        <li><a href="#ç‰¹æ®Šå€¼">ç‰¹æ®Šå€¼</a></li>
        <li><a href="#é˜»å¡">é˜»å¡</a></li>
        <li><a href="#è¶…æ—¶">è¶…æ—¶</a></li>
        <li><a href="#é˜»å¡é˜Ÿåˆ—æ“ä½œ">é˜»å¡é˜Ÿåˆ—æ“ä½œ</a></li>
        <li><a href="#ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¡ˆä¾‹">ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¡ˆä¾‹</a></li>
        <li><a href="#synchronousqueue">SynchronousQueue</a></li>
      </ol>
    </li>
    <li><a href="#çº¿ç¨‹æ± ">çº¿ç¨‹æ± </a>
      <ol>
        <li><a href="#çº¿ç¨‹æ± æ¡†æ¶">çº¿ç¨‹æ± æ¡†æ¶</a></li>
        <li><a href="#executorsç¦ç”¨">Executors(ç¦ç”¨)</a></li>
        <li><a href="#çº¿ç¨‹æ± å·¥ä½œåŸç†">çº¿ç¨‹æ± å·¥ä½œåŸç†</a>
          <ol>
            <li><a href="#å¦‚ä½•åˆ›å»ºçº¿ç¨‹æ± ">å¦‚ä½•åˆ›å»ºçº¿ç¨‹æ± ï¼Ÿ</a></li>
            <li><a href="#7ä¸ªå‚æ•°">7ä¸ªå‚æ•°</a></li>
            <li><a href="#çº¿ç¨‹æ± å·¥ä½œåŸç†-1">çº¿ç¨‹æ± å·¥ä½œåŸç†</a></li>
            <li><a href="#æ‹’ç»ç­–ç•¥">æ‹’ç»ç­–ç•¥</a></li>
          </ol>
        </li>
        <li><a href="#è‡ªå®šä¹‰çº¿ç¨‹æ± ">è‡ªå®šä¹‰çº¿ç¨‹æ± </a></li>
        <li><a href="#æ€»ç»“">æ€»ç»“</a></li>
      </ol>
    </li>
    <li><a href="#å¤šçº¿ç¨‹é«˜å¹¶å‘åº•å±‚åŸç†">å¤šçº¿ç¨‹é«˜å¹¶å‘åº•å±‚åŸç†</a>
      <ol>
        <li><a href="#javaå†…å­˜æ¨¡å‹jmm">Javaå†…å­˜æ¨¡å‹(JMM)</a></li>
        <li><a href="#volatileå…³é”®å­—">volatileå…³é”®å­—</a>
          <ol>
            <li><a href="#å¯è§æ€§">å¯è§æ€§</a></li>
            <li><a href="#æœ‰åºæ€§">æœ‰åºæ€§</a></li>
            <li><a href="#åŸå­æ€§">åŸå­æ€§</a></li>
            <li><a href="#ä¿è¯ä¸‰å¤§ç‰¹æ€§">ä¿è¯ä¸‰å¤§ç‰¹æ€§</a></li>
          </ol>
        </li>
        <li><a href="#cas">CAS</a></li>
        <li><a href="#aqs">AQS</a>
          <ol>
            <li><a href="#ä»€ä¹ˆæ˜¯aqs"><strong>ä»€ä¹ˆæ˜¯AQS</strong></a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#reentrantlock">ReentrantLock</a>
      <ol>
        <li><a href="#ä¸Šé”è°ƒè¯•å…¬å¹³é”è§£é”">ä¸Šé”ï¼Œè°ƒè¯•å…¬å¹³é”ï¼Œè§£é”</a></li>
        <li><a href="#aqsçš„åº•å±‚åŸç†">AQSçš„åº•å±‚åŸç†</a></li>
      </ol>
    </li>
    <li><a href="#è‡ªæ—‹é”">è‡ªæ—‹é”</a>
      <ol>
        <li><a href="#è‡ªæ—‹é”ä¼˜ç‚¹">è‡ªæ—‹é”ä¼˜ç‚¹</a></li>
        <li><a href="#è‡ªæ—‹é”ç¼ºç‚¹">è‡ªæ—‹é”ç¼ºç‚¹</a></li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/yuan/categories/%E9%A2%98%E5%BA%93/" >
                é¢˜åº“
            </a>
        
            <a href="/yuan/categories/java/" >
                Java
            </a>
        
            <a href="/yuan/categories/juc/" >
                Juc
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/yuan/p/juc_wzt/">juc_wzt</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">2025-01-09</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    é˜…è¯»æ—¶é•¿: 18 åˆ†é’Ÿ
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h2 id="jucæ¦‚è¿°">JUCæ¦‚è¿°
</h2><h3 id="ä»€ä¹ˆæ˜¯juc">ä»€ä¹ˆæ˜¯JUCï¼Ÿ
</h3><p>java.util.concurrentåŒ…ä¸­æä¾›çš„å¹¶å‘ç¼–ç¨‹çš„å·¥å…·ç±»</p>
<p>å®ƒæä¾›å¤šç§å·¥å…·ç±»ï¼šåŸå­ç±»ï¼Œçº¿ç¨‹æ± ï¼Œå¹¶å‘é›†åˆï¼ŒåŒæ­¥å™¨</p>
<h3 id="è¿›ç¨‹ä¸çº¿ç¨‹">è¿›ç¨‹ä¸çº¿ç¨‹ï¼š
</h3><p>è¿›ç¨‹ï¼šå…·å¤‡ç‹¬ç«‹åŠŸèƒ½çš„ç¨‹åºè½¯ä»¶å…³äºæŸä¸ªæ•°æ®é›†åˆçš„ä¾æ¬¡è¿è¡Œæ´»åŠ¨</p>
<p>æ“ä½œç³»ç»ŸåŠ¨æ€æ‰§è¡Œçš„åŸºæœ¬å•ä½</p>
<p>çº¿ç¨‹ï¼šä¸€ä¸ªè¿›ç¨‹åŒ…å«ä¸€ä¸ªæˆ–è€…å¤šä¸ªçº¿ç¨‹</p>
<p>ç‹¬ç«‹è¿è¡Œå’Œè°ƒåº¦çš„åŸºæœ¬å•ä½</p>
<h3 id="å¹¶è¡Œå’Œå¹¶å‘">å¹¶è¡Œå’Œå¹¶å‘ï¼š
</h3><p>å¹¶è¡Œï¼šå¤šä¸ªçº¿ç¨‹åŒæ—¶è·‘ï¼Œå¹²ä¸åŒçš„äº‹</p>
<p>å¹¶å‘ï¼šå¤šä¸ªçº¿ç¨‹å¯¹åŒä¸€èµ„æºçš„æŠ¢å </p>
<h3 id="åŒæ­¥å’Œå¼‚æ­¥">åŒæ­¥å’Œå¼‚æ­¥ï¼š
</h3><p>åŒæ­¥ï¼šä»»åŠ¡æŒ‰é¡ºåºä¾æ¬¡æ‰§è¡Œï¼Œæ¯ä¸€ä¸ªä»»åŠ¡å¿…é¡»ç­‰å¾…å‰ä¸€ä¸ªä»»åŠ¡å®Œæˆ</p>
<p>å¼‚æ­¥ï¼šåŒæ—¶å‘èµ·è¯·æ±‚ï¼Œä¸éœ€è¦ç­‰å¾…ç»“æœï¼Œç»“æœå›æ¥å</p>
<h3 id="çº¿ç¨‹çš„çŠ¶æ€">çº¿ç¨‹çš„çŠ¶æ€ï¼š
</h3><ol>
<li>æ–°å»ºï¼ˆNewï¼‰ï¼šçº¿ç¨‹è¢«åˆ›å»ºä½†å°šæœªå¯åŠ¨æ‰§è¡Œã€‚</li>
<li>å°±ç»ªï¼ˆRunnableï¼‰ï¼šçº¿ç¨‹ç­‰å¾…CPUæ—¶é—´ç‰‡ä»¥ä¾¿æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯å¤„äºå°±ç»ªçŠ¶æ€ã€‚</li>
<li>é˜»å¡ï¼ˆBlockedï¼‰ï¼šçº¿ç¨‹æš‚åœæ‰§è¡Œï¼Œé€šå¸¸æ˜¯å› ä¸ºç­‰å¾…æŸäº›æ¡ä»¶æ»¡è¶³ï¼Œä¾‹å¦‚ç­‰å¾…I/Oæ“ä½œå®Œæˆã€ç­‰å¾…é”é‡Šæ”¾ç­‰ã€‚</li>
<li>æ— é™æœŸç­‰å¾…ï¼ˆWaitingï¼‰ï¼šçº¿ç¨‹æ— é™æœŸåœ°ç­‰å¾…æŸä¸ªæ¡ä»¶çš„å‘ç”Ÿï¼Œé€šå¸¸éœ€è¦å…¶ä»–çº¿ç¨‹æ¥å”¤é†’å®ƒã€‚</li>
<li>æœ‰é™æœŸç­‰å¾…ï¼ˆTimed Waitingï¼‰ï¼šçº¿ç¨‹ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œè¶…è¿‡æŒ‡å®šæ—¶é—´åä¼šè‡ªåŠ¨å”¤é†’ã€‚</li>
<li>ç»ˆæ­¢ï¼ˆTerminatedï¼‰ï¼šçº¿ç¨‹æ‰§è¡Œå®Œæˆæˆ–è€…å¼‚å¸¸ç»ˆæ­¢ï¼Œè¿›å…¥ç»ˆæ­¢çŠ¶æ€ã€‚</li>
</ol>
<p>æšä¸¾æ²¡èµ‹å€¼ä¼šç»™å®ƒèµ‹åˆå€¼ï¼Œä»0å¼€å§‹ç´¯åŠ </p>
<h3 id="waitå’Œsleep">waitå’Œsleep
</h3><p>åŒºåˆ«ï¼š</p>
<p>waitéœ€è¦ <code>notify()</code>æˆ–<code>notifyAll()</code>æ–¹æ³•æ¥å”¤é†’    å¿…é¡»åœ¨é”ç¯å¢ƒä¸‹ä½¿ç”¨</p>
<p>sleepæ˜¯å½“å‰çº¿ç¨‹æš‚åœæ‰§è¡ŒæŒ‡å®šæ—¶é—´ï¼Œæ—¶é—´åˆ°å”¤é†’</p>
<h3 id="åˆ›å»ºçº¿ç¨‹">åˆ›å»ºçº¿ç¨‹ï¼š
</h3><p><strong>åˆ›å»ºçº¿ç¨‹å¸¸ç”¨çš„ä¸¤ç§æ–¹å¼</strong>ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="mf">1.</span> <span class="err">ç»§æ‰¿</span><span class="ne">Thread</span><span class="err">ï¼š</span><span class="n">javaæ˜¯å•ç»§æ‰¿</span><span class="err">ï¼Œèµ„æºå®è´µï¼Œè¦ç”¨æ¥å£æ–¹å¼</span> <span class="k">extends</span> <span class="ne">Thread</span>
</span></span><span class="line"><span class="cl"><span class="mf">2.</span> <span class="err">å®ç°</span><span class="n">Runableæ¥å£</span> <span class="n">implements</span> <span class="n">Runnable</span>
</span></span><span class="line"><span class="cl"><span class="mf">3.</span> <span class="n">implements</span> <span class="n">Callable</span>
</span></span><span class="line"><span class="cl"><span class="mf">4.</span> <span class="n">ThreadPoolExecutor</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>*********************************************************************************************è§†é¢‘ç»†èŠ‚éœ€è¦è¡¥å……</p>
<h4 id="ç»§æ‰¿threadæŠ½è±¡ç±»">ç»§æ‰¿ThreadæŠ½è±¡ç±»ï¼š
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">class</span> <span class="nc">T1</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Thread</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;Thread....&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">super</span><span class="p">.</span><span class="na">run</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ThreadDemo</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">T1</span><span class="w"> </span><span class="n">t1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">T1</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">t1</span><span class="p">.</span><span class="na">start</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="å®ç°runableæ¥å£">å®ç°Runableæ¥å£:
</h4><p>æ–°å»ºç±»å®ç°runnableæ¥å£ï¼šè¿™ç§æ–¹æ³•ä¼šæ–°å¢ç±»ï¼Œæœ‰æ›´å¥½çš„æ–¹æ³•</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">class</span> <span class="nc">T2</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Runnable</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="s">&#34; runnable....&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ThreadDemo</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">T2</span><span class="p">(),</span><span class="w"> </span><span class="s">&#34;çº¿ç¨‹å&#34;</span><span class="p">).</span><span class="na">start</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>åŒ¿åå†…éƒ¨ç±»æ–¹å¼ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Runnable</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> 		</span><span class="c1">// è°ƒç”¨èµ„æºæ–¹æ³•ï¼Œå®Œæˆä¸šåŠ¡é€»è¾‘</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">},</span><span class="w"> </span><span class="s">&#34;your thread name&#34;</span><span class="p">).</span><span class="na">start</span><span class="p">();</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>lambdaè¡¨è¾¾å¼æ–¹å¼ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(()</span><span class="o">-&gt;</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// è°ƒç”¨èµ„æºæ–¹æ³•ï¼Œå®Œæˆä¸šåŠ¡é€»è¾‘</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">},</span><span class="w"> </span><span class="s">&#34;your thread name&#34;</span><span class="p">).</span><span class="na">start</span><span class="p">();</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="synchronized">synchronized
</h3><p><strong>å¤šçº¿ç¨‹ç¼–ç¨‹æ¨¡æ¿ï¼ˆä¸Šï¼‰ï¼š</strong></p>
<ul>
<li>é«˜å†…èš ä½è€¦åˆ   ï¼ˆå°†ä»£ç è¿›è¡Œä¸€å®šçš„å°è£…ï¼Œè¿›è¡Œé‡å¤ï¼Œç‹¬ç«‹ä½¿ç”¨ï¼‰</li>
<li><strong>çº¿ç¨‹ æ“ä½œ èµ„æºç±»</strong></li>
</ul>
<p><strong>å®ç°æ­¥éª¤ï¼š</strong></p>
<ol>
<li>åˆ›å»ºèµ„æºç±»</li>
<li>èµ„æºç±»é‡Œåˆ›å»ºåŒæ­¥æ–¹æ³•ã€åŒæ­¥ä»£ç å—</li>
<li>å¤šçº¿ç¨‹è°ƒç”¨</li>
</ol>
<p>ä¾‹å­ï¼šå–ç¥¨ç¨‹åº</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span><span class="w"> </span><span class="nn">com.atguigu.demojuc.chap01</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//èµ„æºç±»ä¸­å†…èšæ“ä½œèµ„æºçš„æ–¹æ³•ï¼Œé™ä½çº¿ç¨‹æ“ä½œèµ„æºçš„è€¦åˆæ€§</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">class</span> <span class="nc">Ticket</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">//  å®šä¹‰ä¸€ä¸ªç¥¨æ•°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">20</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">//  å®šä¹‰ä¸€ä¸ªå–ç¥¨çš„æ–¹æ³•: å‡ºç°äº†èµ„æºæŠ¢å ï¼›</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">//  synchronized: ä½¿ç”¨synchronizedåŒæ­¥æ–¹æ³•è§£å†³</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">synchronized</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">sale</span><span class="p">(){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//  åˆ¤æ–­</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">number</span><span class="o">&lt;=</span><span class="n">0</span><span class="p">){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;ç¥¨å·²å”®ç½„ï¼&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;å¼€å§‹å”®ç¥¨ï¼Œå½“å‰ç¥¨æ•°ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">number</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="n">200</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;ä¹°ç¥¨å”®ç¥¨ï¼Œå‰©ä½™ç¥¨æ•°ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="o">--</span><span class="n">number</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InterruptedException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SaleTicket</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//  åˆ›å»ºèµ„æºç±»å¯¹è±¡</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Ticket</span><span class="w"> </span><span class="n">ticket</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Ticket</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//  åˆ›å»ºçº¿ç¨‹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(()</span><span class="o">-&gt;</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">21</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">ticket</span><span class="p">.</span><span class="na">sale</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">},</span><span class="s">&#34;A&#34;</span><span class="p">).</span><span class="na">start</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(()</span><span class="o">-&gt;</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">21</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">ticket</span><span class="p">.</span><span class="na">sale</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">},</span><span class="s">&#34;B&#34;</span><span class="p">).</span><span class="na">start</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(()</span><span class="o">-&gt;</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">21</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">ticket</span><span class="p">.</span><span class="na">sale</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">},</span><span class="s">&#34;C&#34;</span><span class="p">).</span><span class="na">start</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="synchronizedçš„8é”é—®é¢˜">synchronizedçš„8é”é—®é¢˜
</h3><p>synchronizedé”çš„æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ç±»å¯¹è±¡ã€å®ä¾‹å¯¹è±¡
</span></span></code></pre></td></tr></table>
</div>
</div><p>javaä¸­çš„æ¯ä¸€ä¸ªå¯¹è±¡éƒ½å¯ä»¥ä½œä¸ºé”ã€‚å…·ä½“è¡¨ç°ä¸ºä»¥ä¸‹3ç§å½¢å¼ï¼š</p>
<ol>
<li>å¯¹äºæ™®é€šåŒæ­¥æ–¹æ³•ï¼Œé”æ˜¯<code>å½“å‰å®ä¾‹å¯¹è±¡</code>ã€‚</li>
<li>å¯¹äº<code>é™æ€</code>åŒæ­¥æ–¹æ³•ï¼Œé”æ˜¯å½“<code>å‰ç±»çš„Classå¯¹è±¡</code>ã€‚</li>
<li>å¯¹äºåŒæ­¥ä»£ç å—ï¼Œé”æ˜¯Synchonizedæ‹¬å·é‡Œé…ç½®çš„å¯¹è±¡</li>
<li>è€Œé™æ€åŒæ­¥æ–¹æ³•ï¼ˆClasså¯¹è±¡é”ï¼‰ä¸éé™æ€åŒæ­¥æ–¹æ³•ï¼ˆå®ä¾‹å¯¹è±¡é”ï¼‰ä¹‹é—´æ˜¯ä¸ä¼šæœ‰ç«äº‰çš„(é”éƒ½æ˜¯è‡ªå·±çš„)ã€‚</li>
</ol>
<h2 id="locké”">Locké”:
</h2><p>locké”+ä¸‰ä¸ªå®ç°ç±»=JUCé‡Œé¢çš„é”ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">ReentrantLock</span><span class="w"> </span><span class="n">å¯é‡å…¥é”</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="n">è¿™ä¸¤ä¸ªç»Ÿä¸€ç§°ä¸ºè¯»å†™é”</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">ReentrantReadWriteLock</span><span class="p">.</span><span class="na">ReadLock</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">ReentrantReadWriteLock</span><span class="p">.</span><span class="na">WriteLock</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">lockæ˜¯æ¥å£</span><span class="err">ï¼Œ</span><span class="n">ReenrantLock</span><span class="err">ã€</span><span class="n">ReadLock</span><span class="err">ã€</span><span class="n">WriteLockä¸‰ä¸ªæ˜¯lockæ¥å£çš„å®ç°ç±»</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">ReentrantReadWriteLockå®ç°çš„æ˜¯ReadWriteLock</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img src="C:%5cUsers%5cwzt%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250108011015584.png"
	
	
	
	loading="lazy"
	
		alt="image-20250108011015584"
	
	
></p>
<h3 id="reentrantlockå¯é‡å…¥é”">ReentrantLockå¯é‡å…¥é”
</h3><p><code>ReentrantLock</code>æ˜¯å¯é‡å…¥çš„äº’æ–¥é”ï¼Œè™½ç„¶å…·æœ‰ä¸<code>synchronized</code>ç›¸åŒåŠŸèƒ½ï¼Œä½†æ˜¯ä¼šæ¯”<code>synchronized</code>æœ‰æ›´å¤šçš„æ–¹æ³•ï¼Œå› æ­¤æ›´åŠ çµæ´»ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">äº’æ–¥é”ï¼šç‹¬å é”ã€æ‚²è§‚é”   
</span></span><span class="line"><span class="cl">açº¿ç¨‹å¯¹ä¸€ä¸ªèµ„æºåŠ äº†ä¸€æŠŠé”ï¼Œbçº¿ç¨‹å°±æ— æ³•ç»™è¿™ä¸ªèµ„æºåŠ é”
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">é”å¯é‡å…¥ï¼š
</span></span><span class="line"><span class="cl">å¤–å±‚ä»£ç å—å’Œå†…å±‚ä»£ç å—ç”¨åŒä¸€æŠŠé”
</span></span><span class="line"><span class="cl">å¤–å±‚æŠ¢åˆ°é”åä¸éœ€è¦ é‡Šæ”¾é”å†æŠ¢å†…éƒ¨é”
</span></span><span class="line"><span class="cl">ç›´æ¥å¯ä»¥è¿›
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ReentrantLockå’Œsynchronizedéƒ½å…·æœ‰å¯é‡å…¥æ€§
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ä½¿ç”¨ï¼š 
</span></span><span class="line"><span class="cl">ReentrantLock lock = new ReentrantLock();
</span></span><span class="line"><span class="cl">å†ï¼šlock.lock();
</span></span><span class="line"><span class="cl">æ‰§è¡Œå®Œå
</span></span><span class="line"><span class="cl">lock.unlock();
</span></span><span class="line"><span class="cl">ä¸ºäº†é¿å…ä»£ç å‡ºé—®é¢˜ï¼Œè¿™ä¸ªæ–¹æ³•æœ€å¥½æ”¾åˆ°finally(try,catch,finally)é‡Œ
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">class</span> <span class="nc">Ticket</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">ReentrantLock</span><span class="w"> </span><span class="n">lock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ReentrantLock</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">//  å®šä¹‰ä¸€ä¸ªç¥¨æ•°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">//  å®šä¹‰ä¸€ä¸ªå–ç¥¨çš„æ–¹æ³•:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">sale</span><span class="p">(){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">lock</span><span class="p">.</span><span class="na">lock</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//  åˆ¤æ–­</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">number</span><span class="o">&lt;=</span><span class="n">0</span><span class="p">){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;ç¥¨å·²å”®ç½„ï¼&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">lock</span><span class="p">.</span><span class="na">unlock</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;return&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;å¼€å§‹ä¹°ç¥¨ï¼Œå½“å‰ç¥¨æ•°ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">number</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="n">200</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;ä¹°ç¥¨ç»“æŸï¼Œå‰©ä½™ç¥¨æ•°ï¼š&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="o">--</span><span class="n">number</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InterruptedException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;finally&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">lock</span><span class="p">.</span><span class="na">unlock</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="å…¬å¹³é”">å…¬å¹³é”
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">ReentrantLockå¯ä»¥å®ç°å…¬å¹³é”</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">å…¬å¹³é”</span><span class="err">ï¼š</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="n">ä¹Ÿå°±æ˜¯åœ¨é”ä¸Šç­‰å¾…æ—¶é—´æœ€é•¿çš„çº¿ç¨‹ä¼˜å…ˆè·å¾—é”çš„ä½¿ç”¨æƒ</span><span class="err">ã€‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="n">é€šä¿—çš„ç†è§£å°±æ˜¯è°æ’é˜Ÿæ—¶é—´æœ€é•¿è°å…ˆè·å–é”</span><span class="err">ã€‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="err">ï¼ˆ</span><span class="n">å…¬å¹³é”ä¸å…è®¸æ’é˜Ÿ</span><span class="err">ï¼Œ</span><span class="n">éå…¬å¹³é”å…è®¸æ’é˜Ÿ</span><span class="err">ï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="n">å®ç°</span><span class="err">ï¼š</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="kd">private</span><span class="w"> </span><span class="n">ReentrantLock</span><span class="w"> </span><span class="n">lock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ReentrantLock</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="é™æ—¶ç­‰å¾…">é™æ—¶ç­‰å¾…
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">é€šè¿‡æˆ‘ä»¬çš„lock.tryLock()æ–¹æ³•æ¥å®ç° 
</span></span><span class="line"><span class="cl">synchronizedä¸å…·æœ‰é™æ—¶ç­‰å¾…çš„åŠŸèƒ½
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">æœ‰å‚è¡¨ç¤ºç­‰å¾…æŒ‡å®šçš„æ—¶é—´
</span></span><span class="line"><span class="cl">æ— å‚åˆ™è¡¨ç¤ºç«‹å³è¿”å›é”ç”³è¯·çš„ç»“æœ
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">trueè¡¨ç¤ºè·å–é”æˆåŠŸï¼Œfalseè¡¨ç¤ºè·å–é”å¤±è´¥ã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">è¿™ç§æ–¹æ³•å¯ä»¥ç”¨æ¥è§£å†³æ­»é”é—®é¢˜ã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">æ­»é”ï¼š
</span></span><span class="line"><span class="cl">ä¸¤ä¸ªçº¿ç¨‹äº’ç›¸æŠ¢è¢«å¯¹æ–¹æ‹¿åˆ°çš„é”ï¼Œéƒ½ä¸é‡Šæ”¾é”ï¼Œå°±å‡ºç°äº†æ­»é”
</span></span><span class="line"><span class="cl">tryLock èƒ½æ‹¿åˆ°é”å°±å¹²ï¼Œæ‹¿ä¸åˆ°å°±ä¸å¹²äº†
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="reentrantlockå’ŒsynchronizedåŒºåˆ«">ReentrantLockå’ŒsynchronizedåŒºåˆ«
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">1.ä¸¤ä¸ªéƒ½æ˜¯ç‹¬å é”ï¼Œ
</span></span><span class="line"><span class="cl">ä½†æ˜¯synchronizedåŠ é”è§£é”æ˜¯è‡ªåŠ¨ æ˜“äºæ“ä½œï¼Œä¸çµæ´»
</span></span><span class="line"><span class="cl">ReentarantLockåŠ é”è§£é”éœ€è¦æ‰‹åŠ¨ ä¸æ˜“äºæ“ä½œï¼Œä½†çµæ´»
</span></span><span class="line"><span class="cl">2.ä¸¤ä¸ªéƒ½æ˜¯å¯é‡å…¥
</span></span><span class="line"><span class="cl">ä½†å› ä¸ºsynchronizedåŠ é”è§£é”æ˜¯è‡ªåŠ¨ï¼Œä¸æ‹…å¿ƒæœ€åæ˜¯å¦é‡Šæ”¾é”
</span></span><span class="line"><span class="cl">ReentarantLockåŠ é”è§£é”éœ€è¦æ‰‹åŠ¨ï¼Œä¸”åŠ é”ä¸€æ¬¡å°±éœ€è¦è§£é”ï¼Œå¦åˆ™å…¶ä»–çº¿ç¨‹æ— æ³•è·å¾—é”
</span></span><span class="line"><span class="cl">3.synchronizedä¸å¯å“åº”ä¸­æ–­ï¼Œä¸€ä¸ªçº¿ç¨‹è·å–ä¸åˆ°é”å°±ä¸€ç›´ç­‰ç€
</span></span><span class="line"><span class="cl">  ReentrantLockå¯ä»¥å“åº”ä¸­æ–­ï¼ˆtryLockæ–¹æ³•ï¼šè·å–ä¸åˆ°é”åˆ™è¿”å›falseï¼‰
</span></span><span class="line"><span class="cl">4.  synchronizedä¸å…·å¤‡è®¾ç½®å…¬å¹³é”çš„ç‰¹ç‚¹ï¼ŒReentrantLockå¯ä»¥æˆä¸ºå…¬å¹³é”ã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="reentrantreadwritelockè¯»å†™é”">ReentrantReadWriteLockè¯»å†™é”
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">è¯»å†™é”å…è®¸åŒä¸€æ—¶åˆ»è¢«å¤šä¸ªè¯»çº¿ç¨‹è®¿é—®ï¼Œä½†æ˜¯åœ¨å†™çº¿ç¨‹è®¿é—®æ—¶ï¼Œæ‰€æœ‰çš„è¯»çº¿ç¨‹å’Œå…¶ä»–çš„å†™çº¿ç¨‹éƒ½ä¼šè¢«é˜»å¡ã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">æ•…ï¼šä¸€èˆ¬ç”¨äºå¤šè¯»å†™å°‘æƒ…å†µ
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç‰¹ç‚¹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">1. å†™å†™ä¸å¯å¹¶å‘   
</span></span><span class="line"><span class="cl">ä¸¤ä¸ªçº¿ç¨‹éƒ½æ‹¿åˆ°å†™é”ï¼Œä¸€ä¸ªå†™çš„æ—¶å€™å¦ä¸€ä¸ªä¸èƒ½å†™
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">2. è¯»å†™ä¸å¯å¹¶å‘/å†™è¯»ä¸å¯å¹¶å‘
</span></span><span class="line"><span class="cl"> ä¸€ä¸ªè¯»æ—¶å¦ä¸€ä¸ªå†™ä¸äº†ï¼Œä¸€ä¸ªå†™æ—¶å¦ä¸€ä¸ªä¹Ÿè¯»ä¸äº†
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">3. è¯»è¯»å¯ä»¥å¹¶å‘
</span></span><span class="line"><span class="cl">ä¸¤ä¸ªçº¿ç¨‹éƒ½æ‹¿åˆ°è¯»é”ï¼Œä¸¤ä¸ªçº¿ç¨‹éƒ½èƒ½è¯»
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">è¯»å†™é”ä¿è¯äº†å†™æ“ä½œçš„åŸå­æ€§ï¼Œå¹¶ä¸”å¯ä»¥è¿›è¡Œå¹¶å‘è¯»
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="é”é™çº§">é”é™çº§
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">åœ¨å½“å‰çº¿ç¨‹æ‹¥æœ‰å†™é”çš„æƒ…å†µä¸‹ï¼Œè·å–åˆ°è¯»é”ï¼Œéšåé‡Šæ”¾å†™é”çš„è¿‡ç¨‹å°±æ˜¯é”é™çº§ã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ä¸ºäº†å‡å°‘é”çš„ç«äº‰ï¼Œæé«˜ç¨‹åºçš„å¹¶å‘æ€§èƒ½
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">é”é™çº§çš„å…¸å‹åœºæ™¯æ˜¯åœ¨æŒæœ‰æŸä¸ªå†™é”æ—¶ï¼Œé‡Šæ”¾å†™é”å¹¶è·å–è¯»é”ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯åœ¨æ‰§è¡Œè¯»æ“ä½œæœŸé—´ï¼Œå…¶ä»–çº¿ç¨‹å¯ä»¥åŒæ—¶æ‰§è¡Œè¯»æ“ä½œï¼Œæé«˜äº†å¹¶å‘æ€§èƒ½ã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="è¯»å†™é”æ€»ç»“">è¯»å†™é”æ€»ç»“
</h3><ol>
<li>
<p>æ”¯æŒå…¬å¹³/éå…¬å¹³ç­–ç•¥</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">æ”¯æŒå…¬å¹³é”å’Œéå…¬å¹³é”åˆ‡æ¢
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="D:/BJ240923Java%28%e9%98%b3%e5%93%a5%e5%bc%9f%e5%ad%90%e7%8f%ad%29/%e8%af%be%e4%bb%b6/02_JUC/01_%e8%af%be%e4%bb%b6/assets/1615100164370.png"
	
	
	
	loading="lazy"
	
		alt="1615100164370"
	
	
></p>
</li>
<li>
<p>æ”¯æŒå¯é‡å…¥</p>
<ul>
<li>åŒä¸€è¯»çº¿ç¨‹åœ¨è·å–äº†è¯»é”åè¿˜å¯ä»¥è·å–è¯»é”</li>
<li>åŒä¸€å†™çº¿ç¨‹åœ¨è·å–äº†å†™é”ä¹‹åæ—¢å¯ä»¥å†æ¬¡è·å–å†™é”åˆå¯ä»¥è·å–è¯»é”</li>
<li>åŒä¸€è¯»çº¿ç¨‹åœ¨è·å–äº†è¯»é”å<strong>ä¸å¯ä»¥</strong>è·å–å†™é”</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">å¯é‡å…¥æ€§éƒ½æ˜¯é’ˆå¯¹åŒä¸€çº¿ç¨‹è€Œè¨€
</span></span><span class="line"><span class="cl">è¯»é”è¯»é”å¯ä»¥
</span></span><span class="line"><span class="cl">å†™é”å†™é”å¯ä»¥
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">è¯»é”å†™é”ä¸å¯ä»¥
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>æ”¯æŒé”é™çº§ï¼Œä¸æ”¯æŒé”å‡çº§</p>
</li>
<li>
<p>è¯»å†™é”å¦‚æœä½¿ç”¨ä¸å½“ï¼Œå¾ˆå®¹æ˜“äº§ç”Ÿâ€œé¥¥é¥¿â€é—®é¢˜ï¼š</p>
<p>åœ¨è¯»çº¿ç¨‹éå¸¸å¤šï¼Œå†™çº¿ç¨‹å¾ˆå°‘çš„æƒ…å†µä¸‹ï¼Œå¾ˆå®¹æ˜“å¯¼è‡´å†™çº¿ç¨‹â€œé¥¥é¥¿â€ï¼Œè™½ç„¶ä½¿ç”¨â€œå…¬å¹³â€ç­–ç•¥å¯ä»¥ä¸€å®šç¨‹åº¦ä¸Šç¼“è§£è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯â€œå…¬å¹³â€ç­–ç•¥æ˜¯ä»¥ç‰ºç‰²ç³»ç»Ÿååé‡ä¸ºä»£ä»·çš„ã€‚</p>
</li>
</ol>
<blockquote>
<p>é”é¥¥é¥¿ï¼ˆLock Starvationï¼‰æ˜¯æŒ‡åœ¨å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­çš„ä¸€ç§æƒ…å†µï¼Œå…¶ä¸­æŸäº›çº¿ç¨‹å¯èƒ½æ— æ³•è·å¾—æ‰€éœ€çš„é”ï¼Œè€Œä¸€ç›´ç­‰å¾…ä¸‹å»ï¼Œä»è€Œæ— æ³•ç»§ç»­æ‰§è¡Œï¼Œå³çº¿ç¨‹è¢«&quot;é¥¿æ­»&quot;åœ¨ç­‰å¾…é”çš„è¿‡ç¨‹ä¸­ã€‚è¿™å¯èƒ½ä¼šå¯¼è‡´åº”ç”¨ç¨‹åºçš„æ€§èƒ½é—®é¢˜å’Œä¸ç¨³å®šæ€§ã€‚</p>
</blockquote>
<h2 id="çº¿ç¨‹é—´é€šä¿¡">çº¿ç¨‹é—´é€šä¿¡
</h2><p>é¢è¯•é¢˜æ¡ˆä¾‹</p>
<p>ä¸¤ä¸ªçº¿ç¨‹ï¼Œä¸€ä¸ªçº¿ç¨‹æ‰“å°1-52ï¼Œå¦ä¸€ä¸ªéƒ½è¦å¼„å­—æ¯A-Zï¼Œæ‰“å°é¡ºåºä¸º12A34B&hellip;5152Zï¼Œè¦æ±‚ç”¨çº¿ç¨‹é—´é€šä¿¡</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"></code></pre></td></tr></table>
</div>
</div><p><strong>çº¿ç¨‹é—´é€šä¿¡æ¨¡å‹</strong></p>
<ol>
<li>ç”Ÿäº§è€…+æ¶ˆè´¹è€…</li>
<li>é€šçŸ¥ç­‰å¾…å”¤é†’æœºåˆ¶</li>
</ol>
<h3 id="å¤šçº¿ç¨‹ç¼–ç¨‹æ¨¡æ¿ä¸­">å¤šçº¿ç¨‹ç¼–ç¨‹æ¨¡æ¿(ä¸­)
</h3><p>1.åˆ¤æ–­</p>
<p>2.å¹²æ´»</p>
<p>3.é€šçŸ¥</p>
<p>ä¸¤ä¸ªçº¿ç¨‹æ“ä½œä¸€ä¸ªåˆå§‹å€¼ä¸º0çš„å˜é‡ï¼Œå®ç°ä¸€ä¸ªçº¿ç¨‹å¯¹å˜é‡å¢åŠ 1ï¼Œä¸€ä¸ªçº¿ç¨‹å¯¹å˜é‡å‡å°‘1ï¼Œäº¤æ›¿10è½®ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span><span class="w"> </span><span class="nn">com.atguigu.demojuc.chap03</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">class</span> <span class="nc">ShareDataOne</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     *  å¢åŠ 1
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">synchronized</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">increment</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">InterruptedException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 1. åˆ¤æ–­</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">number</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">wait</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 2. å¹²æ´»</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">number</span><span class="o">++</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;: &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">number</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 3. é€šçŸ¥</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">notifyAll</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * å‡å°‘1
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">synchronized</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">decrement</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">InterruptedException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 1. åˆ¤æ–­</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">number</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">wait</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 2. å¹²æ´»</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">number</span><span class="o">--</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;: &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">number</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 3. é€šçŸ¥</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">notifyAll</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * ç°åœ¨ä¸¤ä¸ªçº¿ç¨‹ï¼Œ
</span></span></span><span class="line"><span class="cl"><span class="cm"> * å¯ä»¥æ“ä½œåˆå§‹å€¼ä¸ºé›¶çš„ä¸€ä¸ªå˜é‡ï¼Œ
</span></span></span><span class="line"><span class="cl"><span class="cm"> * å®ç°ä¸€ä¸ªçº¿ç¨‹å¯¹è¯¥å˜é‡åŠ 1ï¼Œä¸€ä¸ªçº¿ç¨‹å¯¹è¯¥å˜é‡å‡1ï¼Œ
</span></span></span><span class="line"><span class="cl"><span class="cm"> * äº¤æ›¿ï¼Œ10è½®ã€‚
</span></span></span><span class="line"><span class="cl"><span class="cm"> *
</span></span></span><span class="line"><span class="cl"><span class="cm"> * ç¬”è®°ï¼šJavaé‡Œé¢å¦‚ä½•è¿›è¡Œå·¥ç¨‹çº§åˆ«çš„å¤šçº¿ç¨‹ç¼–å†™
</span></span></span><span class="line"><span class="cl"><span class="cm"> * 1 å¤šçº¿ç¨‹ç¼–ç¨‹æ¨¡æ¿ï¼ˆå¥—è·¯ï¼‰
</span></span></span><span class="line"><span class="cl"><span class="cm"> *    1.1  çº¿ç¨‹    æ“ä½œ    èµ„æºç±»
</span></span></span><span class="line"><span class="cl"><span class="cm"> *    1.2  é«˜å†…èš  ä½è€¦åˆ
</span></span></span><span class="line"><span class="cl"><span class="cm"> * 2 å¤šçº¿ç¨‹ç¼–ç¨‹æ¨¡æ¿ï¼ˆå¥—è·¯ï¼‰
</span></span></span><span class="line"><span class="cl"><span class="cm"> *    2.1  åˆ¤æ–­
</span></span></span><span class="line"><span class="cl"><span class="cm"> *    2.2  å¹²æ´»
</span></span></span><span class="line"><span class="cl"><span class="cm"> *    2.3  é€šçŸ¥
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">NotifyWaitDemo</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">ShareDataOne</span><span class="w"> </span><span class="n">shareDataOne</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ShareDataOne</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(()</span><span class="o">-&gt;</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">10</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">shareDataOne</span><span class="p">.</span><span class="na">increment</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InterruptedException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">},</span><span class="w"> </span><span class="s">&#34;AAA&#34;</span><span class="p">).</span><span class="na">start</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(()</span><span class="o">-&gt;</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">10</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">shareDataOne</span><span class="p">.</span><span class="na">decrement</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InterruptedException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">},</span><span class="w"> </span><span class="s">&#34;BBB&#34;</span><span class="p">).</span><span class="na">start</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>éƒ¨åˆ†æ‰“å°ç»“æœï¼šAAAå’ŒBBBäº¤äº’æ‰§è¡Œï¼Œæ‰§è¡Œç»“æœæ˜¯1 0 1 0&hellip; ä¸€å…±10è½®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">AAA: 1
</span></span><span class="line"><span class="cl">BBB: 0
</span></span><span class="line"><span class="cl">AAA: 1
</span></span><span class="line"><span class="cl">BBB: 0
</span></span><span class="line"><span class="cl">AAA: 1
</span></span><span class="line"><span class="cl">BBB: 0
</span></span><span class="line"><span class="cl">AAA: 1
</span></span><span class="line"><span class="cl">BBB: 0
</span></span><span class="line"><span class="cl">ã€‚ã€‚ã€‚ã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="è™šå‡å”¤é†’">è™šå‡å”¤é†’
</h3><p>æ¢æˆ4ä¸ªçº¿ç¨‹ä¼šå¯¼è‡´é”™è¯¯ï¼Œ<strong>è™šå‡å”¤é†’</strong></p>
<p>**åŸå› ï¼š**åœ¨javaå¤šçº¿ç¨‹åˆ¤æ–­æ—¶ï¼Œä¸èƒ½ç”¨ifï¼Œç¨‹åºå‡ºäº‹å‡ºåœ¨äº†åˆ¤æ–­ä¸Šé¢ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">è¿›è¡Œwait()æ—¶åˆ¤æ–­æ¡ä»¶ä½¿ç”¨ifäº†ï¼Œå¯¼è‡´è™šå‡å”¤é†’
</span></span></code></pre></td></tr></table>
</div>
</div><p>**æ³¨æ„ï¼š**æ¶ˆè´¹è€…è¢«å”¤é†’åæ˜¯ä»wait()æ–¹æ³•ï¼ˆè¢«é˜»å¡çš„åœ°æ–¹ï¼‰åé¢æ‰§è¡Œï¼Œè€Œä¸æ˜¯é‡æ–°ä»åŒæ­¥å—å¼€å¤´ã€‚</p>
<p><img src="C:%5cUsers%5cwzt%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250108204207737.png"
	
	
	
	loading="lazy"
	
		alt="image-20250108204207737"
	
	
></p>
<p>è§£å†³è™šå‡å”¤é†’ï¼šæŸ¥çœ‹APIï¼Œjava.lang.Objectçš„waitæ–¹æ³•</p>
<p><img src="C:%5cUsers%5cwzt%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250108204356946.png"
	
	
	
	loading="lazy"
	
		alt="image-20250108204356946"
	
	
></p>
<p>ä¸­æ–­å’Œè™šå‡å”¤é†’æ˜¯å¯èƒ½äº§ç”Ÿçš„ï¼Œæ‰€ä»¥è¦ç”¨å¾ªç¯ï¼Œifåªåˆ¤æ–­ä¸€æ¬¡ï¼Œwhileæ˜¯åªè¦å”¤é†’å°±è¦é‡æ–°å†åˆ¤æ–­ä¸€æ¬¡ã€‚</p>
<p><strong>å¤šçº¿ç¨‹ç¼–ç¨‹æ¨¡æ¿ï¼ˆä¸‹ï¼‰ï¼š</strong></p>
<p>é˜²æ­¢è™šå‡å”¤é†’ï¼ˆä½¿ç”¨whileï¼Œä»£æ›¿ifï¼‰</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">// 1. åˆ¤æ–­
</span></span><span class="line"><span class="cl">while (number != 0) {
</span></span><span class="line"><span class="cl">    this.wait();
</span></span><span class="line"><span class="cl">}
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">// 1. åˆ¤æ–­
</span></span><span class="line"><span class="cl">while (number != 1) {
</span></span><span class="line"><span class="cl">    this.wait();
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="çº¿ç¨‹é€šä¿¡condition">çº¿ç¨‹é€šä¿¡ï¼ˆConditionï¼‰
</h3><p>çº¿ç¨‹é—´é€šä¿¡æœ‰ä¸¤å¥—ä»£ç å¼€å‘æ–¹å¼</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">1.wait+notify/notifyall+synchronized
</span></span><span class="line"><span class="cl">wait+notify/notifyallå¿…é¡»åœ¨æœ‰é”çš„ç¯å¢ƒä¸‹ä½¿ç”¨ï¼Œæ‰€ä»¥å¿…é¡»è·Ÿsynchronizedç»“åˆåšå¼€å‘
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">å¦‚æœä½¿ç”¨JUCä¸­çš„locké”ï¼Œ
</span></span><span class="line"><span class="cl">é€šè¿‡Conditionæ¥å®ç°é€šçŸ¥å”¤é†’(ä»£æ›¿wait+notify/notifyall)
</span></span><span class="line"><span class="cl">2.lock+condition
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="C:%5cUsers%5cwzt%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250108205706976.png"
	
	
	
	loading="lazy"
	
		alt="image-20250108205706976"
	
	
></p>
<p>ä¸Šé¢æ¡ˆä¾‹åªéœ€è¦æ”¹åŠ¨ShareDataOne</p>
<p>å¹¶å»æ‰ increment å’Œ decrement æ–¹æ³•çš„synchronized</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">class</span> <span class="nc">ShareDataOne</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">Lock</span><span class="w"> </span><span class="n">lock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ReentrantLock</span><span class="p">();</span><span class="w"> </span><span class="c1">// åˆå§‹åŒ–locké”</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="n">Condition</span><span class="w"> </span><span class="n">condition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lock</span><span class="p">.</span><span class="na">newCondition</span><span class="p">();</span><span class="w"> </span><span class="c1">// åˆå§‹åŒ–conditionå¯¹è±¡</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     *  å¢åŠ 1
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">increment</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">InterruptedException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">lock</span><span class="p">.</span><span class="na">lock</span><span class="p">();</span><span class="w"> </span><span class="c1">// åŠ é”</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// 1. åˆ¤æ–­</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">number</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="c1">// this.wait();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">condition</span><span class="p">.</span><span class="na">await</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// 2. å¹²æ´»</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">number</span><span class="o">++</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;: &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">number</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// 3. é€šçŸ¥</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// this.notifyAll();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">condition</span><span class="p">.</span><span class="na">signalAll</span><span class="p">();</span><span class="w"> </span><span class="c1">//å”¤é†’æ‰€æœ‰ç­‰å¾…çš„çº¿ç¨‹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InterruptedException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">lock</span><span class="p">.</span><span class="na">unlock</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * å‡å°‘1
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">decrement</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">InterruptedException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">lock</span><span class="p">.</span><span class="na">lock</span><span class="p">();</span><span class="w"> </span><span class="c1">// åŠ é”</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// 1. åˆ¤æ–­</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">number</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="c1">// this.wait();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">condition</span><span class="p">.</span><span class="na">await</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// 2. å¹²æ´»</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">number</span><span class="o">--</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;: &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">number</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// 3. é€šçŸ¥</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">// this.notifyAll();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">condition</span><span class="p">.</span><span class="na">signalAll</span><span class="p">();</span><span class="w"> </span><span class="c1">//å”¤é†’æ‰€æœ‰ç­‰å¾…çš„çº¿ç¨‹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InterruptedException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">lock</span><span class="p">.</span><span class="na">unlock</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">condition</span><span class="p">.</span><span class="na">signal</span><span class="p">();</span><span class="w"> </span><span class="c1">// å”¤é†’ä¸€ä¸ªç­‰å¾…çš„çº¿ç¨‹    </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">condition</span><span class="p">.</span><span class="na">signalAll</span><span class="p">();</span><span class="w">  </span><span class="c1">//å”¤é†’æ‰€æœ‰ç­‰å¾…çš„çº¿ç¨‹</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="å®šåˆ¶åŒ–è°ƒç”¨é€šä¿¡">å®šåˆ¶åŒ–è°ƒç”¨é€šä¿¡
</h3><p>çº¿ç¨‹é—´æŒ‰é¡ºåºé€šä¿¡</p>
<p>é¢è¯•é¢˜</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">å¤šçº¿ç¨‹ä¹‹é—´æŒ‰é¡ºåºè°ƒç”¨ï¼Œå®ç°AA-&gt;BB-&gt;CCã€‚ä¸‰ä¸ªçº¿ç¨‹å¯åŠ¨ï¼Œè¦æ±‚å¦‚ä¸‹ï¼š
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		AAæ‰“å°5æ¬¡ï¼ŒBBæ‰“å°10æ¬¡ï¼ŒCCæ‰“å°15æ¬¡
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		æ¥ç€
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		AAæ‰“å°5æ¬¡ï¼ŒBBæ‰“å°10æ¬¡ï¼ŒCCæ‰“å°15æ¬¡
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		ã€‚ã€‚ã€‚æ‰“å°10è½®
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">åˆ†æå®ç°æ–¹å¼ï¼š
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">1. æœ‰ä¸€ä¸ªé”Lockï¼Œ3æŠŠé’¥åŒ™Conditionï¼ˆaå®Œäº†å”¤é†’bï¼Œbå®Œäº†å”¤é†’cï¼‰
</span></span><span class="line"><span class="cl">2. æœ‰é¡ºåºé€šçŸ¥ï¼ˆåˆ‡æ¢çº¿ç¨‹ï¼‰ï¼Œéœ€è¦æœ‰æ ‡è¯†ä½
</span></span><span class="line"><span class="cl">3. åˆ¤æ–­æ ‡å¿—ä½
</span></span><span class="line"><span class="cl">4. è¾“å‡ºçº¿ç¨‹å + å†…å®¹
</span></span><span class="line"><span class="cl">5. ä¿®æ”¹æ ‡è¯†ç¬¦ï¼Œé€šçŸ¥ä¸‹ä¸€ä¸ª
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span><span class="w"> </span><span class="nn">com.atguigu.juc.chap03</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.concurrent.locks.Condition</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.concurrent.locks.Lock</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.util.concurrent.locks.ReentrantLock</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ThreadOrderAccess</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">//å£°æ˜å…¨å±€é”å¯¹è±¡</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">Lock</span><span class="w"> </span><span class="n">lock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ReentrantLock</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">//ä¸ºA,B,Cçº¿ç¨‹å£°æ˜Conditionå¯¹è±¡è´Ÿè´£ä¸åŒçº¿ç¨‹ç­‰å¾…ï¼Œå”¤é†’</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">Condition</span><span class="w"> </span><span class="n">conditionA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lock</span><span class="p">.</span><span class="na">newCondition</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">Condition</span><span class="w"> </span><span class="n">conditionB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lock</span><span class="p">.</span><span class="na">newCondition</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">Condition</span><span class="w"> </span><span class="n">conditionC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lock</span><span class="p">.</span><span class="na">newCondition</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">//å£°æ˜å…¨å±€flagæ ‡è¯†ï¼Œä½œä¸ºçº¿ç¨‹é˜»å¡ï¼Œæ‰§è¡Œæ¡ä»¶</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * Açº¿ç¨‹è´Ÿè´£è°ƒç”¨æ‰“å°5æ¬¡æ–¹æ³•
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">print5</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//1.å…ˆè·å–é”</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">lock</span><span class="p">.</span><span class="na">lock</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//2.åˆ¤æ–­Açº¿ç¨‹ç­‰å¾…æ¡ä»¶ï¼ˆä¸ç­‰äº1å°†å½“å‰çº¿ç¨‹è¿›å…¥ç­‰å¾…çŠ¶æ€ï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">flag</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">conditionA</span><span class="p">.</span><span class="na">await</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//3.å¹²æ´»ï¼ˆflag=1åˆ™æ‰“å°5æ¬¡æ‰§è¡Œï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">5</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;,&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//4.å°†flagæ ‡è¯†ä¿®æ”¹ä¸º2ï¼Œå”¤é†’Bçº¿ç¨‹å¹²æ´»</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">flag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">2</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">conditionB</span><span class="p">.</span><span class="na">signalAll</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InterruptedException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RuntimeException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//5.å°†é”é‡Šæ”¾</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">lock</span><span class="p">.</span><span class="na">unlock</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * Bçº¿ç¨‹è´Ÿè´£è°ƒç”¨æ‰“å°10æ¬¡æ–¹æ³•
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">print10</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//1.å…ˆè·å–é”</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">lock</span><span class="p">.</span><span class="na">lock</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//2.åˆ¤æ–­Bçº¿ç¨‹ç­‰å¾…æ¡ä»¶ï¼ˆä¸ç­‰äº2å°†å½“å‰çº¿ç¨‹è¿›å…¥ç­‰å¾…çŠ¶æ€ï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">flag</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">conditionB</span><span class="p">.</span><span class="na">await</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//3.å¹²æ´»ï¼ˆflag=2åˆ™æ‰“å°10æ¬¡æ‰§è¡Œï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">10</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;,&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//4.å°†flagæ ‡è¯†ä¿®æ”¹ä¸º3ï¼Œå”¤é†’Cçº¿ç¨‹å¹²æ´»</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">flag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">3</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">conditionC</span><span class="p">.</span><span class="na">signalAll</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InterruptedException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RuntimeException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//5.å°†é”é‡Šæ”¾</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">lock</span><span class="p">.</span><span class="na">unlock</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * Cçº¿ç¨‹è´Ÿè´£è°ƒç”¨æ‰“å°15æ¬¡æ–¹æ³•
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">print15</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//1.å…ˆè·å–é”</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">lock</span><span class="p">.</span><span class="na">lock</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//2.åˆ¤æ–­Cçº¿ç¨‹ç­‰å¾…æ¡ä»¶ï¼ˆä¸ç­‰äº3å°†å½“å‰çº¿ç¨‹è¿›å…¥ç­‰å¾…çŠ¶æ€ï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">flag</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">conditionC</span><span class="p">.</span><span class="na">await</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//3.å¹²æ´»ï¼ˆflag=3åˆ™æ‰“å°15æ¬¡æ‰§è¡Œï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">15</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;,&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//4.å°†flagæ ‡è¯†ä¿®æ”¹ä¸º1ï¼Œå”¤é†’Açº¿ç¨‹å¹²æ´»</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">flag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">conditionA</span><span class="p">.</span><span class="na">signalAll</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InterruptedException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RuntimeException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//5.å°†é”é‡Šæ”¾</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">lock</span><span class="p">.</span><span class="na">unlock</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//2.åˆ›å»ºèµ„æºç±»å¯¹è±¡</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">ThreadOrderAccess</span><span class="w"> </span><span class="n">orderAccess</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ThreadOrderAccess</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//1.åˆ›å»ºä¸‰ä¸ªçº¿ç¨‹A,B,C</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(()</span><span class="o">-&gt;</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">10</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">orderAccess</span><span class="p">.</span><span class="na">print5</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">},</span><span class="w"> </span><span class="s">&#34;A&#34;</span><span class="p">).</span><span class="na">start</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(()</span><span class="o">-&gt;</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">10</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">orderAccess</span><span class="p">.</span><span class="na">print10</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">},</span><span class="w"> </span><span class="s">&#34;B&#34;</span><span class="p">).</span><span class="na">start</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(()</span><span class="o">-&gt;</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">10</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">orderAccess</span><span class="p">.</span><span class="na">print15</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">},</span><span class="w"> </span><span class="s">&#34;C&#34;</span><span class="p">).</span><span class="na">start</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">åœ¨Javaä¸­ï¼Œä¸€ä¸ªReentrantLockå¯ä»¥ä¸å¤šä¸ªConditionå¯¹è±¡ä¸€èµ·ä½¿ç”¨
</span></span><span class="line"><span class="cl">æ¯ä¸ªConditionå¯¹è±¡å¯ä»¥ç”¨äºä¸åŒçš„çº¿ç¨‹åè°ƒå’Œé€šä¿¡åœºæ™¯
</span></span><span class="line"><span class="cl">ä»¥ä¾¿æ›´ç²¾ç»†åœ°æ§åˆ¶å¤šçº¿ç¨‹ä¹‹é—´çš„æ‰§è¡Œé¡ºåºå’Œäº’æ–¥è®¿é—®ã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="å¹¶å‘å®¹å™¨ç±»">å¹¶å‘å®¹å™¨ç±»
</h2><p><strong>Vectorå’ŒSynchronizedçš„ç¼ºç‚¹ï¼š</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="o">-</span><span class="w"> </span><span class="n">Vector</span><span class="err">ï¼š</span><span class="n">å†…å­˜æ¶ˆè€—æ¯”è¾ƒå¤§</span><span class="err">ï¼Œ</span><span class="n">é€‚åˆä¸€æ¬¡å¢é‡æ¯”è¾ƒå¤§çš„æƒ…å†µ</span><span class="err">ï¼ˆ</span><span class="n">Vectoræ¯æ¬¡æ‰©å®¹æ˜¯åŸæ¥å®¹é‡çš„ä¸€å€</span><span class="err">ï¼Œ</span><span class="n">ArrayListæ˜¯åŸæ¥çš„1</span><span class="p">.</span><span class="na">5å€</span><span class="err">ï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//Vectorï¼šè¯»å–åŠ é”ï¼</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">-</span><span class="w"> </span><span class="n">SynchronizedList</span><span class="err">ï¼š</span><span class="n">è¿­ä»£å™¨æ¶‰åŠçš„ä»£ç æ²¡æœ‰åŠ ä¸Šçº¿ç¨‹åŒæ­¥ä»£ç </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//synchronizedListï¼š è¯»å–æ•°æ®ï¼šè¯»å–æ•°æ®æ²¡æœ‰åŠ é”ï¼</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="copyonwrite"><strong>CopyOnWrite</strong>
</h3><h4 id="ä»€ä¹ˆæ˜¯copyonwriteå®¹å™¨">ä»€ä¹ˆæ˜¯CopyOnWriteå®¹å™¨
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">CopyOnWriteå®¹å™¨ï¼ˆç®€ç§°COWå®¹å™¨ï¼‰å³å†™æ—¶å¤åˆ¶çš„å®¹å™¨ã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">é€šä¿—çš„ç†è§£ï¼š
</span></span><span class="line"><span class="cl">å½“æˆ‘ä»¬å¾€ä¸€ä¸ªå®¹å™¨æ·»åŠ å…ƒç´ çš„æ—¶å€™ï¼Œä¸ç›´æ¥å¾€å½“å‰å®¹å™¨æ·»åŠ ï¼Œè€Œæ˜¯å…ˆå°†å½“å‰å®¹å™¨è¿›è¡ŒCopyï¼Œå¤åˆ¶å‡ºä¸€ä¸ªæ–°çš„å®¹å™¨ï¼Œç„¶åæ–°çš„å®¹å™¨é‡Œæ·»åŠ å…ƒç´ ï¼Œæ·»åŠ å®Œå…ƒç´ ä¹‹åï¼Œå†å°†åŸå®¹å™¨çš„å¼•ç”¨æŒ‡å‘æ–°çš„å®¹å™¨ã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">å¥½å¤„ï¼š
</span></span><span class="line"><span class="cl">å¯ä»¥å¯¹CopyOnWriteå®¹å™¨è¿›è¡Œå¹¶å‘çš„è¯»ï¼Œè€Œä¸éœ€è¦åŠ é”
</span></span><span class="line"><span class="cl">å› ä¸ºå½“å‰å®¹å™¨ä¸ä¼šæ·»åŠ ä»»ä½•å…ƒç´ ã€‚æ‰€ä»¥CopyOnWriteå®¹å™¨ä¹Ÿæ˜¯ä¸€ç§è¯»å†™åˆ†ç¦»çš„æ€æƒ³ï¼Œè¯»å’Œå†™ä¸åŒçš„å®¹å™¨ã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">è¯»å†™åˆ†ç¦»ï¼š
</span></span><span class="line"><span class="cl">å†™çš„æ—¶å€™ä¸å½±å“è¯»ï¼Œè¯»å†™æ˜¯åˆ†å¼€çš„
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">ä»JDK1</span><span class="p">.</span><span class="na">5å¼€å§‹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Javaå¹¶å‘åŒ…é‡Œæä¾›äº†ä¸¤ä¸ªä½¿ç”¨CopyOnWriteæœºåˆ¶å®ç°çš„å¹¶å‘å®¹å™¨</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">CopyOnWriteArrayList</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//æ˜¯çº¿ç¨‹å®‰å…¨çš„ List å®ç°ï¼Œå®ƒé€šè¿‡å¤åˆ¶åº•å±‚æ•°ç»„çš„æ–¹å¼ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œé€‚ç”¨äºè¯»å¤šå†™å°‘çš„åœºæ™¯ã€‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">CopyOnWriteArraySet</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//æ˜¯CopyOnWriteArrayList çš„ Set ç‰ˆæœ¬</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="åº”ç”¨åœºæ™¯">åº”ç”¨åœºæ™¯ï¼š
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">CopyOnWriteå¹¶å‘å®¹å™¨ç”¨äº è¯»å¤šå†™å°‘ çš„å¹¶å‘åœºæ™¯ï¼šç™½åå•ï¼Œé»‘åå•
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">åœºæ™¯ï¼š
</span></span><span class="line"><span class="cl">å‡å¦‚æˆ‘ä»¬æœ‰ä¸€ä¸ªæœç´¢ç½‘ç«™ï¼Œç”¨æˆ·åœ¨è¿™ä¸ªç½‘ç«™çš„æœç´¢æ¡†ä¸­ï¼Œè¾“å…¥å…³é”®å­—æœç´¢å†…å®¹ï¼Œä½†æ˜¯æŸäº›å…³é”®å­—ä¸å…è®¸è¢«æœç´¢ã€‚è¿™äº›ä¸èƒ½è¢«æœç´¢çš„å…³é”®å­—ä¼šè¢«æ”¾åœ¨ä¸€ä¸ªé»‘åå•å½“ä¸­ï¼Œé»‘åå•ä¸€å®šå‘¨æœŸæ‰ä¼šæ›´æ–°ä¸€æ¬¡ã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ç¼ºç‚¹">ç¼ºç‚¹
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">1</span><span class="p">.</span><span class="w"> </span><span class="n">å†…å­˜å ç”¨é—®é¢˜</span><span class="err">ã€‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//å†™çš„æ—¶å€™ä¼šåˆ›å»ºæ–°å¯¹è±¡æ·»åŠ åˆ°æ–°å®¹å™¨é‡Œï¼Œè€Œæ—§å®¹å™¨çš„å¯¹è±¡è¿˜åœ¨ä½¿ç”¨ï¼Œæ‰€ä»¥æœ‰ä¸¤ä»½å¯¹è±¡å†…å­˜ã€‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//2å€å†…å­˜ç©ºé—´</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">2</span><span class="p">.</span><span class="w"> </span><span class="n">æ•°æ®ä¸€è‡´æ€§é—®é¢˜</span><span class="err">ã€‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//CopyOnWriteå®¹å™¨åªèƒ½ä¿è¯æ•°æ®çš„æœ€ç»ˆä¸€è‡´æ€§ï¼Œä¸èƒ½ä¿è¯æ•°æ®çš„å®æ—¶ä¸€è‡´æ€§ã€‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//æ‰€ä»¥å¦‚æœä½ å¸Œæœ›å†™å…¥çš„æ•°æ®ï¼Œé©¬ä¸Šèƒ½è¯»åˆ°ï¼Œè¯·ä¸è¦ä½¿ç”¨CopyOnWriteå®¹å™¨ã€‚è¯»çš„æ•°æ®å¯èƒ½æ˜¯å°±æ—§æ•°ç»„</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="concurrenthashmap">ConcurrentHashMap
</h3><p><strong>ç‰¹ç‚¹</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">1</span><span class="p">.</span><span class="w"> </span><span class="n">å¹¶å‘æ€§</span><span class="err">ï¼š</span><span class="n">ConcurrentHashMap</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//å…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®ï¼Œè¯»æ“ä½œä¸ä¼šè¢«é˜»å¡ï¼Œä¸éœ€è¦åŠ é”ã€‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//è¿™æ„å‘³ç€å¤šä¸ªçº¿ç¨‹å¯ä»¥å¹¶å‘åœ°è¯»å–å…¶ä¸­çš„æ•°æ®ï¼Œè€Œä¸ä¼šå‘ç”Ÿç«äº‰æˆ–é”å®šã€‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">2</span><span class="p">.</span><span class="w"> </span><span class="n">åˆ†æ®µé”</span><span class="err">ï¼š</span><span class="n">ConcurrentHashMap</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//ConcurrentHashMapæ˜¯çº¿ç¨‹å®‰å…¨çš„Mapå®¹å™¨</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//JDK8ä¹‹å‰ï¼ŒConcurrentHashMapä½¿ç”¨é”åˆ†æ®µæŠ€æœ¯ï¼Œå°†æ•°æ®åˆ†æˆä¸€æ®µæ®µå­˜å‚¨ï¼Œæ¯ä¸ªæ•°æ®æ®µé…ç½®ä¸€æŠŠé”ï¼Œå³segmentç±»ï¼Œè¿™ä¸ªç±»ç»§æ‰¿ReentrantLockæ¥ä¿è¯çº¿ç¨‹å®‰å…¨ï¼ŒJKD8çš„ç‰ˆæœ¬å–æ¶ˆSegmentè¿™ä¸ªåˆ†æ®µé”æ•°æ®ç»“æ„ï¼Œåº•å±‚ä¹Ÿæ˜¯ä½¿ç”¨Nodeæ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘ï¼Œä»è€Œå®ç°å¯¹æ¯ä¸€æ®µæ•°æ®å°±è¡ŒåŠ é”ï¼Œä¹Ÿå‡å°‘äº†å¹¶å‘å†²çªçš„æ¦‚ç‡ã€‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//è¿™ç§è®¾è®¡å…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶è¿›è¡Œè¯»æ“ä½œï¼Œåªæœ‰åœ¨å†™æ“ä½œæ—¶æ‰éœ€è¦é”å®šç›¸åº”çš„æ®µï¼Œä»¥ç¡®ä¿çº¿ç¨‹å®‰å…¨ã€‚è¿™æé«˜äº†å¹¶å‘æ€§èƒ½ï¼Œå› ä¸ºä¸åŒæ®µä¹‹é—´çš„æ“ä½œä¸ä¼šç›¸äº’é˜»å¡ã€‚</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">ConcurrentHashMapæ˜¯ä¸€ä¸ªç”¨äºé«˜å¹¶å‘ç¯å¢ƒçš„éå¸¸æœ‰ç”¨çš„æ•°æ®ç»“æ„</span><span class="err">ã€‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">å®ƒæä¾›äº†é«˜æ•ˆçš„å¹¶å‘è®¿é—®æ”¯æŒ</span><span class="err">ï¼Œ</span><span class="n">å…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶è¯»å–å’Œå†™å…¥æ•°æ®</span><span class="err">ï¼Œ</span><span class="n">è€Œä¸éœ€è¦æ˜¾å¼çš„é”å®š</span><span class="err">ã€‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">åœºæ™¯</span><span class="err">ï¼š</span><span class="n">å¹¶å‘ç¼–ç¨‹ä¸­éœ€è¦é«˜æ•ˆåœ°å¤„ç†å…±äº«æ•°æ®çš„æƒ…å†µ</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>å¹¶å‘å®‰å…¨é›†åˆç±»éƒ½å“ªäº›ï¼Ÿ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">ConcurrentHashMap</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//æ˜¯çº¿ç¨‹å®‰å…¨çš„å“ˆå¸Œè¡¨å®ç°,å®ƒé€šè¿‡åˆ†æ®µé”çš„æœºåˆ¶æ¥å®ç°å¹¶å‘è®¿é—®çš„é«˜æ•ˆæ€§ã€‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">CopyOnWriteArrayList</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//æ˜¯çº¿ç¨‹å®‰å…¨çš„ List å®ç°ï¼Œå®ƒé€šè¿‡å¤åˆ¶åº•å±‚æ•°ç»„çš„æ–¹å¼ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œé€‚ç”¨äºè¯»å¤šå†™å°‘çš„åœºæ™¯ã€‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">CopyOnWriteArraySet</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//æ˜¯ CopyOnWriteArrayList çš„ Set ç‰ˆæœ¬</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">BlockingQueue</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//æ˜¯ä¸€ä¸ªç”¨äºåœ¨å¤šçº¿ç¨‹é—´ä¼ é€’æ•°æ®çš„é˜Ÿåˆ—æ¥å£,å®ƒåŒ…å«å¤šä¸ªå®ç°ç±»ï¼Œå¦‚ ArrayBlockingQueueã€LinkedBlockingQueue</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="jucå¼ºå¤§çš„è¾…åŠ©ç±»">JUCå¼ºå¤§çš„è¾…åŠ©ç±»
</h2><ol>
<li>CountDownLatchï¼ˆå€’è®¡æ•°å™¨ï¼‰</li>
<li>CyclicBarrierï¼ˆå¾ªç¯æ …æ ï¼‰</li>
<li>Semaphoreï¼ˆä¿¡å·é‡</li>
</ol>
<h3 id="countdownlatch">CountDownLatch
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">å€’è®¡æ•°å™¨</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">å¸¸ç”¨æ–¹æ³•</span><span class="err">ï¼š</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">new</span><span class="w"> </span><span class="n">CountDownLatch</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">//å®ä¾‹åŒ–ä¸€ä¸ªå€’è®¡æ•°å™¨ï¼ŒcountæŒ‡å®šåˆå§‹è®¡æ•°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">countDown</span><span class="p">()</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">// æ¯è°ƒç”¨ä¸€æ¬¡ï¼Œè®¡æ•°å‡ä¸€</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">await</span><span class="p">()</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">//ç­‰å¾…ï¼Œå½“è®¡æ•°å‡åˆ°0æ—¶ï¼Œé˜»å¡çº¿ç¨‹ï¼ˆå¯ä»¥æ˜¯ä¸€ä¸ªï¼Œä¹Ÿå¯ä»¥æ˜¯å¤šä¸ªï¼‰å¹¶è¡Œæ‰§è¡Œ</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">ä½¿ç”¨</span><span class="err">ï¼š</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">ex</span><span class="err">ï¼š</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">//6ä¸ªåŒå­¦(å­çº¿ç¨‹)é™†ç»­ç¦»å¼€æ•™å®¤åå€¼ç­åŒå­¦ï¼ˆä¸»çº¿ç¨‹ï¼‰æ‰å¯ä»¥å…³é—¨</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">InterruptedException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//1.åˆ›å»ºå€’è®¡æ•°å™¨å¯¹è±¡</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">CountDownLatch</span><span class="w"> </span><span class="n">countDownLatch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">CountDownLatch</span><span class="p">(</span><span class="n">6</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//2.å¾ªç¯åˆ›å»º6ä¸ªå­çº¿ç¨‹åˆ†åˆ«æ‰§è¡Œå„è‡ªä¸šåŠ¡ï¼ˆå®Œæˆè¯¾åä½œä¸šï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">6</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(()</span><span class="o">-&gt;</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span><span class="o">+</span><span class="s">&#34;ï¼Œå¼€å§‹å­¦ä¹ &#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">TimeUnit</span><span class="p">.</span><span class="na">SECONDS</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Random</span><span class="p">().</span><span class="na">nextInt</span><span class="p">(</span><span class="n">10</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InterruptedException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RuntimeException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span><span class="o">+</span><span class="s">&#34;ï¼Œç»“æŸå­¦ä¹ &#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">countDownLatch</span><span class="p">.</span><span class="na">countDown</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">           
</span></span></span><span class="line"><span class="cl"><span class="w">                
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">},</span><span class="w"> </span><span class="s">&#34;åŒå­¦&#34;</span><span class="o">+</span><span class="n">i</span><span class="p">).</span><span class="na">start</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//3.ä¸»çº¿ç¨‹é˜»å¡ç­‰å¾…å„ä¸ªå­çº¿ç¨‹æ‰§è¡Œç»“æŸ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">countDownLatch</span><span class="p">.</span><span class="na">await</span><span class="p">(</span><span class="n">10</span><span class="p">,</span><span class="w"> </span><span class="n">TimeUnit</span><span class="p">.</span><span class="na">SECONDS</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span><span class="o">+</span><span class="s">&#34;ç­é•¿é”é—¨ï¼Œèµ°äººï¼&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ç»“æœï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">åŒå­¦1ï¼Œå¼€å§‹å­¦ä¹ 
</span></span><span class="line"><span class="cl">åŒå­¦4ï¼Œå¼€å§‹å­¦ä¹ 
</span></span><span class="line"><span class="cl">åŒå­¦3ï¼Œå¼€å§‹å­¦ä¹ 
</span></span><span class="line"><span class="cl">åŒå­¦2ï¼Œå¼€å§‹å­¦ä¹ 
</span></span><span class="line"><span class="cl">åŒå­¦5ï¼Œå¼€å§‹å­¦ä¹ 
</span></span><span class="line"><span class="cl">åŒå­¦6ï¼Œå¼€å§‹å­¦ä¹ 
</span></span><span class="line"><span class="cl">åŒå­¦5ï¼Œç»“æŸå­¦ä¹ 
</span></span><span class="line"><span class="cl">åŒå­¦2ï¼Œç»“æŸå­¦ä¹ 
</span></span><span class="line"><span class="cl">åŒå­¦4ï¼Œç»“æŸå­¦ä¹ 
</span></span><span class="line"><span class="cl">åŒå­¦1ï¼Œç»“æŸå­¦ä¹ 
</span></span><span class="line"><span class="cl">åŒå­¦6ï¼Œç»“æŸå­¦ä¹ 
</span></span><span class="line"><span class="cl">åŒå­¦3ï¼Œç»“æŸå­¦ä¹ 
</span></span><span class="line"><span class="cl">mainç­é•¿é”é—¨ï¼Œèµ°äººï¼
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="countdownlatch-ä¸-join-æ–¹æ³•çš„åŒºåˆ«">CountDownLatch ä¸ join æ–¹æ³•çš„åŒºåˆ«
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">è°ƒç”¨ä¸€ä¸ªå­çº¿ç¨‹join()æ–¹æ³•åï¼Œè¯¥çº¿ç¨‹ä¼šä¸€ç›´è¢«é˜»å¡ï¼Œç›´åˆ°è¯¥çº¿ç¨‹è¿è¡Œå®Œæ¯•
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> CountDownLatchåˆ™ä½¿ç”¨è®¡æ•°å™¨
</span></span><span class="line"><span class="cl"> å…è®¸å­çº¿ç¨‹è¿è¡Œå®Œæ¯•æˆ–è€…è¿è¡Œä¸­æ—¶å€™é€’å‡è®¡æ•°
</span></span><span class="line"><span class="cl"> ä¹Ÿå°±æ˜¯CountDownLatch å¯ä»¥åœ¨å­çº¿ç¨‹è¿è¡Œä»»ä½•æ—¶å€™è®© await æ–¹æ³•è¿”å›è€Œä¸ä¸€å®šå¿…é¡»ç­‰åˆ°çº¿ç¨‹ç»“æŸï¼›
</span></span><span class="line"><span class="cl"> (awaitç±»ä¼¼waitï¼Œä¸è¿‡waité…åˆsynchronizedå…³é”®å­—ï¼Œawaité…åˆlockæ¥å£)
</span></span><span class="line"><span class="cl"> countDownLatch ç›¸æ¯” Join æ–¹æ³•è®©æˆ‘ä»¬å¯¹çº¿ç¨‹åŒæ­¥æœ‰æ›´çµæ´»çš„æ§åˆ¶ã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="cyclicbarrier">CyclicBarrier
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">å¾ªç¯æ …æ </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">å¤§æ¦‚çš„æ„æ€å°±æ˜¯ä¸€ä¸ªå¯å¾ªç¯åˆ©ç”¨çš„å±éšœ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nl">ä¸»è¦ä½œç”¨æ˜¯</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">åœ¨å¤šä¸ªçº¿ç¨‹ç›¸äº’ç­‰å¾…è¾¾åˆ°æŸä¸ªå…±åŒç‚¹ä¹‹åå†ä¸€èµ·ç»§ç»­æ‰§è¡Œ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">å¸¸ç”¨æ–¹æ³•</span><span class="err">ï¼š</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">1</span><span class="p">.</span><span class="w"> </span><span class="nf">CyclicBarrier</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">parties</span><span class="p">,</span><span class="w"> </span><span class="n">Runnable</span><span class="w"> </span><span class="n">barrierAction</span><span class="p">)</span><span class="w"> </span><span class="n">åˆ›å»ºä¸€ä¸ªCyclicBarrierå®ä¾‹</span><span class="err">ï¼Œ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">partiesæŒ‡å®šå‚ä¸ç›¸äº’ç­‰å¾…çš„çº¿ç¨‹æ•°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">barrierActionä¸€ä¸ªå¯é€‰çš„Runnableå‘½ä»¤</span><span class="err">ï¼Œ</span><span class="n">è¯¥å‚æ•°åªåœ¨æ¯ä¸ªå±éšœç‚¹è¿è¡Œä¸€æ¬¡</span><span class="err">ï¼Œ</span><span class="n">å¯ä»¥åœ¨æ‰§è¡Œåç»­ä¸šåŠ¡ä¹‹å‰å…±äº«çŠ¶æ€</span><span class="err">ã€‚</span><span class="n">è¯¥æ“ä½œç”±æœ€åä¸€ä¸ªè¿›å…¥å±éšœç‚¹çš„çº¿ç¨‹æ‰§è¡Œ</span><span class="err">ã€‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">2</span><span class="p">.</span><span class="w"> </span><span class="nf">CyclicBarrier</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">parties</span><span class="p">)</span><span class="w"> </span><span class="n">åˆ›å»ºä¸€ä¸ªCyclicBarrierå®ä¾‹</span><span class="err">ï¼Œ</span><span class="n">partiesæŒ‡å®šå‚ä¸ç›¸äº’ç­‰å¾…çš„çº¿ç¨‹æ•°</span><span class="err">ã€‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">3</span><span class="p">.</span><span class="w"> </span><span class="nf">await</span><span class="p">()</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">è¯¥æ–¹æ³•è¢«è°ƒç”¨æ—¶è¡¨ç¤ºå½“å‰çº¿ç¨‹å·²ç»åˆ°è¾¾å±éšœç‚¹</span><span class="err">ï¼Œ</span><span class="n">å½“å‰çº¿ç¨‹é˜»å¡è¿›å…¥ä¼‘çœ çŠ¶æ€</span><span class="err">ï¼Œ`</span><span class="n">ç›´åˆ°æ‰€æœ‰çº¿ç¨‹éƒ½åˆ°è¾¾å±éšœç‚¹</span><span class="err">`ï¼Œ</span><span class="n">å½“å‰çº¿ç¨‹æ‰ä¼šè¢«å”¤é†’</span><span class="err">ã€‚</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">ä½¿ç”¨</span><span class="err">ï¼š</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">ex</span><span class="err">ï¼š</span><span class="n">ç»„é˜Ÿæ‰“bossè¿‡å…³å¡æ¸¸æˆ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">å…±è®¡ä¸‰ä¸ªçº¿ç¨‹</span><span class="err">ï¼ˆ</span><span class="n">ç©å®¶</span><span class="err">ï¼‰ï¼Œ</span><span class="n">è¦æ±‚æ‰€æœ‰çº¿ç¨‹æ‰§è¡Œå®ŒæŸä¸€å…³</span><span class="err">ï¼ˆ</span><span class="n">åˆ°è¾¾æŸä¸ªå±éšœç‚¹</span><span class="err">ï¼‰ï¼Œ</span><span class="n">æ‰èƒ½å¤Ÿç»§ç»­æ‰§è¡Œä¸‹ä¸€å…³</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//1.å£°æ˜å¾ªç¯æ …æ å¯¹è±¡ p1:çº¿ç¨‹æ•°é‡ p2:æ‰€æœ‰çº¿ç¨‹åˆ°è¾¾å±éšœç‚¹åæ‰§è¡Œä¸šåŠ¡-ç”±æœ€åä¸€ä¸ªåˆ°è¾¾å±éšœç‚¹çº¿ç¨‹æ‰§è¡Œ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">CyclicBarrier</span><span class="w"> </span><span class="n">cyclicBarrier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">CyclicBarrier</span><span class="p">(</span><span class="n">3</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span><span class="o">+</span><span class="s">&#34;ï¼ˆè£åˆ¤ï¼‰,æ‰€æœ‰ç©å®¶éƒ½å®Œæˆè¯¥å…³å¡ï¼Œç»§ç»­...&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">});</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//2.åˆ›å»ºä¸‰ä¸ªçº¿ç¨‹ï¼Œä¸šåŠ¡é€»è¾‘ï¼Œçº¿ç¨‹é—´äº’ç›¸ç­‰å¾…ï¼Œå…¨éƒ¨åˆ°è¾¾å±éšœç‚¹ï¼Œæ‰ç»§ç»­</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">3</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="c1">//2.1 æ¨¡æ‹Ÿå½“å‰çº¿ç¨‹è¿‡æ¸¸æˆæ‰€æœ‰å…³å¡</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;ï¼Œå¼€å§‹è¿‡ç¬¬1å…³&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">TimeUnit</span><span class="p">.</span><span class="na">SECONDS</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Random</span><span class="p">().</span><span class="na">nextInt</span><span class="p">(</span><span class="n">5</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;ï¼Œç¬¬1å…³,å·²è¿‡&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">cyclicBarrier</span><span class="p">.</span><span class="na">await</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="c1">//2.2 å¦‚æœå½“å‰çº¿ç¨‹å…ˆåˆ°è¾¾å±éšœç‚¹ï¼Œå…¶ä»–çº¿ç¨‹è¿˜æœªåˆ°è¾¾ï¼Œå°†å½“å‰çº¿ç¨‹è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œä¸€ç›´åˆ°å…¶ä»–æ‰€æœ‰çº¿ç¨‹å…¨éƒ¨åˆ°è¾¾å±éšœç‚¹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;ï¼Œå¼€å§‹è¿‡ç¬¬2å…³&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">TimeUnit</span><span class="p">.</span><span class="na">SECONDS</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Random</span><span class="p">().</span><span class="na">nextInt</span><span class="p">(</span><span class="n">5</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;ï¼Œç¬¬2å…³,å·²è¿‡&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">cyclicBarrier</span><span class="p">.</span><span class="na">await</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;ï¼Œå¼€å§‹è¿‡ç¬¬3å…³&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">TimeUnit</span><span class="p">.</span><span class="na">SECONDS</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Random</span><span class="p">().</span><span class="na">nextInt</span><span class="p">(</span><span class="n">5</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;ï¼Œç¬¬3å…³,å·²è¿‡&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">cyclicBarrier</span><span class="p">.</span><span class="na">await</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RuntimeException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">},</span><span class="w"> </span><span class="s">&#34;ç©å®¶&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="p">).</span><span class="na">start</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ç»“æœï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ç©å®¶1ï¼Œå¼€å§‹è¿‡ç¬¬1å…³
</span></span><span class="line"><span class="cl">ç©å®¶3ï¼Œå¼€å§‹è¿‡ç¬¬1å…³
</span></span><span class="line"><span class="cl">ç©å®¶2ï¼Œå¼€å§‹è¿‡ç¬¬1å…³
</span></span><span class="line"><span class="cl">ç©å®¶3ï¼Œç¬¬1å…³,å·²è¿‡
</span></span><span class="line"><span class="cl">ç©å®¶1ï¼Œç¬¬1å…³,å·²è¿‡
</span></span><span class="line"><span class="cl">ç©å®¶2ï¼Œç¬¬1å…³,å·²è¿‡
</span></span><span class="line"><span class="cl">ç©å®¶2ï¼ˆè£åˆ¤ï¼‰,æ‰€æœ‰ç©å®¶éƒ½å®Œæˆè¯¥å…³å¡ï¼Œç»§ç»­...
</span></span><span class="line"><span class="cl">ç©å®¶2ï¼Œå¼€å§‹è¿‡ç¬¬2å…³
</span></span><span class="line"><span class="cl">ç©å®¶1ï¼Œå¼€å§‹è¿‡ç¬¬2å…³
</span></span><span class="line"><span class="cl">ç©å®¶3ï¼Œå¼€å§‹è¿‡ç¬¬2å…³
</span></span><span class="line"><span class="cl">ç©å®¶3ï¼Œç¬¬2å…³,å·²è¿‡
</span></span><span class="line"><span class="cl">ç©å®¶2ï¼Œç¬¬2å…³,å·²è¿‡
</span></span><span class="line"><span class="cl">ç©å®¶1ï¼Œç¬¬2å…³,å·²è¿‡
</span></span><span class="line"><span class="cl">ç©å®¶1ï¼ˆè£åˆ¤ï¼‰,æ‰€æœ‰ç©å®¶éƒ½å®Œæˆè¯¥å…³å¡ï¼Œç»§ç»­...
</span></span><span class="line"><span class="cl">ç©å®¶1ï¼Œå¼€å§‹è¿‡ç¬¬3å…³
</span></span><span class="line"><span class="cl">ç©å®¶3ï¼Œå¼€å§‹è¿‡ç¬¬3å…³
</span></span><span class="line"><span class="cl">ç©å®¶2ï¼Œå¼€å§‹è¿‡ç¬¬3å…³
</span></span><span class="line"><span class="cl">ç©å®¶1ï¼Œç¬¬3å…³,å·²è¿‡
</span></span><span class="line"><span class="cl">ç©å®¶2ï¼Œç¬¬3å…³,å·²è¿‡
</span></span><span class="line"><span class="cl">ç©å®¶3ï¼Œç¬¬3å…³,å·²è¿‡
</span></span><span class="line"><span class="cl">ç©å®¶3ï¼ˆè£åˆ¤ï¼‰,æ‰€æœ‰ç©å®¶éƒ½å®Œæˆè¯¥å…³å¡ï¼Œç»§ç»­...
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ³¨ï¼šæ‰€æœ‰çš„&quot;è¿‡å…³äº†&quot;éƒ½æ˜¯ç”±æœ€ååˆ°è¾¾awaitæ–¹æ³•çš„çº¿ç¨‹æ‰§è¡Œæ‰“å°çš„</p>
<h3 id="cyclicbarrierå’Œcountdownlatchçš„åŒºåˆ«">CyclicBarrierå’ŒCountDownLatchçš„åŒºåˆ«
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">- CountDownLatchå…è®¸ä¸€ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹ç­‰å¾…ä¸€ç»„äº‹ä»¶çš„äº§ç”Ÿ
</span></span><span class="line"><span class="cl">è€ŒCyclicBarrierç”¨äºç­‰å¾…å…¶ä»–çº¿ç¨‹è¿è¡Œåˆ°æ …æ ä½ç½®
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">- CountDownLatchçš„è®¡æ•°å™¨åªèƒ½ä½¿ç”¨ä¸€æ¬¡
</span></span><span class="line"><span class="cl">è€ŒCyclicBarrierçš„è®¡æ•°å™¨å¯ä»¥ä½¿ç”¨å¤šæ¬¡
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">- æ‰€ä»¥CyclicBarrierèƒ½å¤Ÿå¤„ç†æ›´ä¸ºå¤æ‚çš„åœºæ™¯
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="semaphore">Semaphore
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">ä¿¡å·é‡</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Semaphoreå¯ä»¥æ§åˆ¶åŒæ—¶è®¿é—®çš„çº¿ç¨‹ä¸ªæ•°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">éå¸¸é€‚åˆéœ€æ±‚é‡å¤§</span><span class="err">ï¼Œ</span><span class="n">è€Œèµ„æºåˆå¾ˆç´§å¼ çš„æƒ…å†µ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">å¸¸ç”¨æ–¹æ³•</span><span class="err">ï¼š</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="nf">Semaphore</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">permits</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// æ„é€ æ–¹æ³•ï¼ŒpermitsæŒ‡èµ„æºæ•°ç›®ï¼ˆä¿¡å·é‡ï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">acquire</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">InterruptedException</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// å ç”¨èµ„æºï¼Œå½“ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨acquireæ“ä½œæ—¶ï¼Œå®ƒè¦ä¹ˆé€šè¿‡æˆåŠŸè·å–ä¿¡å·é‡ï¼ˆä¿¡å·é‡å‡1ï¼‰ï¼Œè¦ä¹ˆä¸€ç›´ç­‰ä¸‹å»ï¼Œç›´åˆ°æœ‰çº¿ç¨‹é‡Šæ”¾ä¿¡å·é‡ï¼Œæˆ–è¶…æ—¶ã€‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">release</span><span class="p">()</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// ï¼ˆé‡Šæ”¾ï¼‰å®é™…ä¸Šä¼šå°†ä¿¡å·é‡çš„å€¼åŠ 1ï¼Œç„¶åå”¤é†’ç­‰å¾…çš„çº¿ç¨‹ã€‚</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸¤ä¸ªç›®çš„ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">1. å¤šä¸ªå…±äº«èµ„æºçš„äº’æ–¥ä½¿ç”¨ã€‚
</span></span><span class="line"><span class="cl">2. ç”¨äºå¹¶å‘çº¿ç¨‹æ•°çš„æ§åˆ¶ã€‚ä¿æŠ¤ä¸€ä¸ªå…³é”®éƒ¨åˆ†ä¸è¦ä¸€æ¬¡è¾“å…¥è¶…è¿‡Nä¸ªçº¿ç¨‹ã€‚ï¼ˆé™æµï¼‰
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">ä½¿ç”¨</span><span class="err">ï¼š</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">ex</span><span class="err">ï¼š</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//6è¾†è½¦ï¼ˆçº¿ç¨‹ï¼‰è¦è¿›å…¥åˆ°åœè½¦åœºå…±è®¡æœ‰3ä¸ªè½¦ä½ï¼ˆä¿¡å·é‡ï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//1.æ„å»ºä¿¡å·é‡å¯¹è±¡</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Semaphore</span><span class="w"> </span><span class="n">semaphore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Semaphore</span><span class="p">(</span><span class="n">3</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//2.å¾ªç¯åˆ›å»º6ä¸ªçº¿ç¨‹ï¼Œæ‹¿åˆ°ä¿¡å·é‡æ‰èƒ½æ‰§è¡Œçº¿ç¨‹ä¸šåŠ¡</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">6</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="c1">//2.1 æ¯ä¸ªè½¦è¾†åªæœ‰æ‹¿åˆ°ä¿¡å·æ‰èƒ½åœè½¦ å½“å‰çº¿ç¨‹ä¼šä¸€ç›´é˜»å¡åˆ°è·å–ä¿¡å·ä¸ºæ­¢</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">semaphore</span><span class="p">.</span><span class="na">acquire</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="c1">//2.2 çº¿ç¨‹ä¸šåŠ¡é€»è¾‘</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span><span class="o">+</span><span class="s">&#34; æŠ¢åˆ°äº†ä¸€ä¸ªåœè½¦ä½ï¼&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">TimeUnit</span><span class="p">.</span><span class="na">SECONDS</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Random</span><span class="p">().</span><span class="na">nextInt</span><span class="p">(</span><span class="n">5</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="c1">//2.3 å½“å‰è½¦è¾†ä¸šåŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œé‡Šæ”¾ä¿¡å·é‡</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span><span class="o">+</span><span class="s">&#34; ç¦»å¼€åœè½¦ä½ï¼ï¼&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">semaphore</span><span class="p">.</span><span class="na">release</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RuntimeException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">},</span><span class="w"> </span><span class="s">&#34;&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="p">).</span><span class="na">start</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>æ‰“å°ç»“æœï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">0 æŠ¢åˆ°äº†ä¸€ä¸ªåœè½¦ä½ï¼ï¼
</span></span><span class="line"><span class="cl">1 æŠ¢åˆ°äº†ä¸€ä¸ªåœè½¦ä½ï¼ï¼
</span></span><span class="line"><span class="cl">2 æŠ¢åˆ°äº†ä¸€ä¸ªåœè½¦ä½ï¼ï¼
</span></span><span class="line"><span class="cl">1 ç¦»å¼€åœè½¦ä½ï¼ï¼
</span></span><span class="line"><span class="cl">3 æŠ¢åˆ°äº†ä¸€ä¸ªåœè½¦ä½ï¼ï¼
</span></span><span class="line"><span class="cl">2 ç¦»å¼€åœè½¦ä½ï¼ï¼
</span></span><span class="line"><span class="cl">4 æŠ¢åˆ°äº†ä¸€ä¸ªåœè½¦ä½ï¼ï¼
</span></span><span class="line"><span class="cl">0 ç¦»å¼€åœè½¦ä½ï¼ï¼
</span></span><span class="line"><span class="cl">5 æŠ¢åˆ°äº†ä¸€ä¸ªåœè½¦ä½ï¼ï¼
</span></span><span class="line"><span class="cl">5 ç¦»å¼€åœè½¦ä½ï¼ï¼
</span></span><span class="line"><span class="cl">3 ç¦»å¼€åœè½¦ä½ï¼ï¼
</span></span><span class="line"><span class="cl">4 ç¦»å¼€åœè½¦ä½ï¼ï¼
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="callableæ¥å£">Callableæ¥å£
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Threadç±»å’ŒRunnableæ¥å£éƒ½`ä¸å…è®¸å£°æ˜æ£€æŸ¥å‹å¼‚å¸¸`ï¼Œ`ä¹Ÿä¸èƒ½å®šä¹‰è¿”å›å€¼`ã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ä»java5å¼€å§‹ï¼Œæä¾›äº†Callableæ¥å£
</span></span><span class="line"><span class="cl">`ç”¨Call()æ–¹æ³•ä½œä¸ºçº¿ç¨‹çš„æ‰§è¡Œä½“ï¼Œå¢å¼ºäº†ä¹‹å‰çš„run()æ–¹æ³•ã€‚`å› ä¸ºcallæ–¹æ³•å¯ä»¥æœ‰è¿”å›å€¼ï¼Œä¹Ÿå¯ä»¥å£°æ˜æŠ›å‡ºå¼‚å¸¸ã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="callableå’Œrunnableå¯¹æ¯”">Callableå’ŒRunnableå¯¹æ¯”
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">runnableï¼šå¼Šç«¯ï¼šæ²¡æœ‰è¿”å›ç»“æœï¼Œä¸èƒ½å£°æ˜æŠ›å¼‚å¸¸  æ¥è‡ªjava.lang
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">callable:ä¼˜åŠ¿ï¼šæœ‰è¿”å›å€¼ï¼ŒæŠ›å¼‚å¸¸  æ¥è‡ªjava.util.concurrent
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="callableçš„ä½¿ç”¨">Callableçš„ä½¿ç”¨
</h3><p><img src="C:%5cUsers%5cwzt%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250108022824339.png"
	
	
	
	loading="lazy"
	
		alt="image-20250108022824339"
	
	
></p>
<p>FutureTaskå…¶å®å¯ä»¥å……å½“äº†ä¸€ä¸ªä¸­é—´äººçš„è§’è‰²</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">class</span> <span class="nc">MyRunnableThread</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Runnable</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34; Runnable&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * 1. åˆ›å»ºCallableçš„å®ç°ç±»ï¼Œå¹¶é‡å†™call()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¸ºçº¿ç¨‹æ‰§è¡Œä½“ï¼Œå¹¶ä¸”è¯¥æ–¹æ³•æœ‰è¿”å›å€¼
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">class</span> <span class="nc">MyCallableThread</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Callable</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="nf">call</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">10</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="n">300</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34; æ‰§è¡Œäº†ï¼&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CallableDemo</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">InterruptedException</span><span class="p">,</span><span class="w"> </span><span class="n">ExecutionException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// åˆ›å»ºå¤šçº¿ç¨‹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">MyRunnableThread</span><span class="p">(),</span><span class="w"> </span><span class="s">&#34;threadName&#34;</span><span class="p">).</span><span class="na">start</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//new Thread(new MyCallableThread(), &#34;threadName&#34;).start();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 2. åˆ›å»ºCallableçš„å®ä¾‹ï¼Œå¹¶ç”¨FutureTaskç±»æ¥åŒ…è£…Callableå¯¹è±¡</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 3. åˆ›å»ºFutureTaskå¯¹è±¡ï¼Œéœ€è¦ä¸€ä¸ªCallableç±»å‹çš„å‚æ•°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">FutureTask</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FutureTask</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">MyCallableThread</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// 4. åˆ›å»ºå¤šçº¿ç¨‹ï¼Œç”±äºFutureTaskçš„æœ¬è´¨æ˜¯Runnableçš„å®ç°ç±»ï¼Œæ‰€ä»¥ç¬¬ä¸€ä¸ªå‚æ•°å¯ä»¥ç›´æ¥ä½¿ç”¨task</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(</span><span class="n">task</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;MyCallableThread&#34;</span><span class="p">).</span><span class="na">start</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//å–æ¶ˆä»»åŠ¡</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//        Thread.sleep(1000);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//        task.cancel(true); //çº¿ç¨‹è¿è¡Œæ—¶å¯ä»¥è¢«æ‰“æ–­å—</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//        boolean cancelled = task.isCancelled();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//        System.out.println(&#34;cancelled &#34; + cancelled);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//ç­‰å¾…ä»»åŠ¡æ‰§è¡Œå®Œæ¯•</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//        while (!task.isDone()) { //ä¹Ÿå¯ä»¥ä½¿ç”¨task.isDone()åˆ¤æ–­å­çº¿ç¨‹æ˜¯å¦æ‰§è¡Œå®Œæ¯•</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//            Thread.sleep(100);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//            System.out.println(&#34;wait...&#34;);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//        }</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//è·å–ç»“æœ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">task</span><span class="p">.</span><span class="na">get</span><span class="p">());</span><span class="c1">//getæ–¹æ³•é˜»å¡ä¸»çº¿ç¨‹ï¼Œå› ä¸ºéœ€è¦è¿”å›å­çº¿ç¨‹çš„ç»“æœ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34; over!&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="futuretask">FutureTask
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">FutureTaskæ˜¯ Java ä¸­çš„ä¸€ä¸ªç±»ï¼Œå®ƒå®ç°äº†Futureå’ŒRunnableæ¥å£ï¼Œç”¨äºè¡¨ç¤ºä¸€ä¸ªå¯å–æ¶ˆçš„å¼‚æ­¥è®¡ç®—ä»»åŠ¡ã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">FutureTask çš„ä¸»è¦ä½œç”¨æ˜¯ï¼š
</span></span><span class="line"><span class="cl">ä¸€ä¸ªçº¿ç¨‹ä¸­è®¡ç®—ç»“æœï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ä¸­è·å–è®¡ç®—æœºçš„ç»“æœï¼ŒåŒæ—¶è¿˜æ”¯æŒä»»åŠ¡çš„å–æ¶ˆæ“ä½œ
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸»è¦ä½œç”¨ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nl">å¼‚æ­¥è®¡ç®—</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="n">å…è®¸å¼€å‘è€…åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œè€—æ—¶çš„è®¡ç®—ä»»åŠ¡è€Œä¸ä¼šé˜»å¡ä¸»çº¿ç¨‹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">è·å–è®¡ç®—ç»“æœ</span><span class="err">ï¼š</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="n">è°ƒç”¨get</span><span class="p">()</span><span class="n">æ–¹æ³•</span><span class="err">ï¼Œ</span><span class="n">è·å–è®¡ç®—ç»“æœ</span><span class="err">ã€‚</span><span class="n">å¦‚æœè®¡ç®—å°šæœªå®Œæˆ</span><span class="err">ï¼Œ</span><span class="n">get</span><span class="p">()</span><span class="n">ä¼šé˜»å¡å½“å‰çº¿ç¨‹</span><span class="err">ï¼Œ</span><span class="n">ç›´åˆ°è®¡ç®—å®Œæˆ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">å–æ¶ˆä»»åŠ¡</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="nf">è°ƒç”¨cancel</span><span class="p">(</span><span class="kt">boolean</span><span class="w"> </span><span class="n">mayInterruptIfRunning</span><span class="p">)</span><span class="n">æ–¹æ³•æ¥å–æ¶ˆä»»åŠ¡çš„æ‰§è¡Œ</span><span class="err">ã€‚</span><span class="w">   </span><span class="n">å¯ä»¥é€‰æ‹©æ˜¯å¦å…è®¸åœ¨ä»»åŠ¡è¿è¡Œæ—¶ä¸­æ–­ä»»åŠ¡</span><span class="err">ã€‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">ä»»åŠ¡çŠ¶æ€æŸ¥è¯¢</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="n">FutureTaskæä¾›äº†ä¸€äº›æ–¹æ³•æ¥æŸ¥è¯¢ä»»åŠ¡çš„çŠ¶æ€</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="nf">isDone</span><span class="p">()</span><span class="n">ç”¨äºæ£€æŸ¥ä»»åŠ¡æ˜¯å¦å·²å®Œæˆ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="nf">isCancelled</span><span class="p">()</span><span class="n">ç”¨äºæ£€æŸ¥ä»»åŠ¡æ˜¯å¦å·²è¢«å–æ¶ˆ</span><span class="err">ã€‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">å¼‚å¸¸å¤„ç†</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="n">å¦‚æœå¼‚æ­¥ä»»åŠ¡æŠ›å‡ºäº†å¼‚å¸¸</span><span class="err">ï¼Œ</span><span class="n">FutureTaskä¼šæ•è·å¼‚å¸¸å¹¶åœ¨åç»­è°ƒç”¨</span><span class="w"> </span><span class="nf">get</span><span class="p">()</span><span class="n">æ–¹æ³•æ—¶é‡æ–°æŠ›å‡º</span><span class="err">ã€‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="n">è·å–è®¡ç®—ç»“æœæ—¶å¤„ç†å¯èƒ½çš„ä¸€åœºæŠ¢çŸ¿</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>æ³¨ï¼š<strong>ä¸ºäº†é˜²æ­¢ä¸»çº¿ç¨‹é˜»å¡ï¼Œå»ºè®®getæ–¹æ³•æ”¾åˆ°æœ€å</strong></p>
<p>â€‹        <strong>åªè®¡ç®—ä¸€æ¬¡</strong>ï¼ŒFutureTaskä¼šå¤ç”¨ä¹‹å‰è®¡ç®—è¿‡çš„ç»“æœ</p>
<p><img src="C:%5cUsers%5cwzt%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250108172948082.png"
	
	
	
	loading="lazy"
	
		alt="image-20250108172948082"
	
	
></p>
<h3 id="callableæ¥å£ä¸runnableæ¥å£çš„åŒºåˆ«">callableæ¥å£ä¸runnableæ¥å£çš„åŒºåˆ«ï¼Ÿ
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">- ç›¸åŒç‚¹ï¼š
</span></span><span class="line"><span class="cl">éƒ½æ˜¯æ¥å£ï¼Œéƒ½å¯ä»¥ç¼–å†™å¤šçº¿ç¨‹ç¨‹åºï¼Œéƒ½é‡‡ç”¨                   Thread.start()å¯åŠ¨çº¿ç¨‹
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">- ä¸åŒç‚¹ï¼š
</span></span><span class="line"><span class="cl">1. å…·ä½“æ–¹æ³•ä¸åŒï¼šä¸€ä¸ªæ˜¯runï¼Œä¸€ä¸ªæ˜¯call
</span></span><span class="line"><span class="cl">2. Runnableæ²¡æœ‰è¿”å›å€¼ï¼›Callableå¯ä»¥è¿”å›æ‰§è¡Œç»“æœï¼Œæ˜¯ä¸ªæ³›å‹
</span></span><span class="line"><span class="cl">3. Callableæ¥å£çš„call()æ–¹æ³•å…è®¸æŠ›å‡ºå¼‚å¸¸ï¼›Runnableçš„run()æ–¹æ³•å¼‚å¸¸åªèƒ½åœ¨å†…éƒ¨æ¶ˆåŒ–ï¼Œä¸èƒ½å¾€ä¸Šç»§ç»­æŠ›
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="è·å–å¤šçº¿ç¨‹çš„æ–¹æ³•">è·å–å¤šçº¿ç¨‹çš„æ–¹æ³•
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ä¼ ç»Ÿï¼š
</span></span><span class="line"><span class="cl">ç»§æ‰¿threadç±»
</span></span><span class="line"><span class="cl">runnableæ¥å£
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">java5ä»¥ååˆæœ‰
</span></span><span class="line"><span class="cl">å®ç°callableæ¥å£å’Œjavaçš„çº¿ç¨‹æ± 
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="é˜»å¡é˜Ÿåˆ—blockingqueue">é˜»å¡é˜Ÿåˆ—ï¼ˆBlockingQueueï¼‰
</h2><h3 id="ä»€ä¹ˆæ˜¯blockingqueue">ä»€ä¹ˆæ˜¯BlockingQueue
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">æ‰€è°“é˜»å¡ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ä¼šæŒ‚èµ·çº¿ç¨‹ï¼ˆå³é˜»å¡ï¼‰ï¼Œä¸€æ—¦æ¡ä»¶æ»¡è¶³ï¼Œè¢«æŒ‚èµ·çš„çº¿ç¨‹åˆä¼šè‡ªåŠ¨è¢«å”¤èµ·ã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><p>BlockingQueueå³é˜»å¡é˜Ÿåˆ—ï¼Œæ˜¯java.util.concurrentä¸‹çš„ä¸€ä¸ªæ¥å£</p>
<p>BlockingQueueæ˜¯ä¸ºäº†è§£å†³å¤šçº¿ç¨‹ä¸­æ•°æ®é«˜æ•ˆå®‰å…¨ä¼ è¾“è€Œæå‡ºçš„ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">è¢«é˜»å¡æƒ…å†µä¸»è¦æœ‰å¦‚ä¸‹ä¸¤ç§ï¼š
</span></span><span class="line"><span class="cl">1. å½“é˜Ÿåˆ—æ»¡äº†çš„æ—¶å€™ï¼Œä¾ç„¶è¿›è¡Œå…¥é˜Ÿåˆ—æ“ä½œ
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">2. å½“é˜Ÿåˆ—ç©ºäº†çš„æ—¶å€™ï¼Œä¾ç„¶è¿›è¡Œå‡ºé˜Ÿåˆ—æ“ä½œ
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">å½“ä¸€ä¸ªçº¿ç¨‹è¯•å›¾å¯¹ä¸€ä¸ªå·²ç»æ»¡äº†çš„é˜Ÿåˆ—è¿›è¡Œå…¥é˜Ÿåˆ—æ“ä½œæ—¶ï¼Œå®ƒå°†ä¼šè¢«é˜»å¡ï¼Œé™¤éæœ‰å¦ä¸€ä¸ªçº¿ç¨‹åšäº†å‡ºé˜Ÿåˆ—æ“ä½œï¼›
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">å½“ä¸€ä¸ªçº¿ç¨‹è¯•å›¾å¯¹ä¸€ä¸ªç©ºé˜Ÿåˆ—è¿›è¡Œå‡ºé˜Ÿåˆ—æ“ä½œæ—¶ï¼Œå®ƒå°†ä¼šè¢«é˜»å¡ï¼Œé™¤éæœ‰å¦ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œäº†å…¥é˜Ÿåˆ—æ“ä½œã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="C:%5cUsers%5cwzt%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250108182133283.png"
	
	
	
	loading="lazy"
	
		alt="image-20250108182133283"
	
	
></p>
<h3 id="blockingqueueæ¥å£">BlockingQueueæ¥å£
</h3><p>ä¸»è¦æœ‰ä»¥ä¸‹7ä¸ªå®ç°ç±»ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">1. ArrayBlockingQueueï¼šç”±æ•°ç»„ç»“æ„ç»„æˆçš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—ã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">2. LinkedBlockingQueueï¼šç”±é“¾è¡¨ç»“æ„ç»„æˆçš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—ã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">3. PriorityBlockingQueueï¼šæ”¯æŒä¼˜å…ˆçº§æ’åºçš„æ— ç•Œé˜»å¡é˜Ÿåˆ—ã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">4. DelayQueueï¼šä½¿ç”¨ä¼˜å…ˆçº§é˜Ÿåˆ—å®ç°çš„å»¶è¿Ÿæ— ç•Œé˜»å¡é˜Ÿåˆ—ã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">5. SynchronousQueueï¼šä¸å­˜å‚¨å…ƒç´ çš„é˜»å¡é˜Ÿåˆ—ï¼Œä¹Ÿå³å•ä¸ªå…ƒç´ çš„é˜Ÿåˆ—ã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">6. LinkedTransferQueueï¼šç”±é“¾è¡¨ç»„æˆçš„æ— ç•Œé˜»å¡é˜Ÿåˆ—ã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">7. LinkedBlockingDequeï¼šç”±é“¾è¡¨ç»„æˆçš„åŒå‘é˜»å¡é˜Ÿåˆ—ã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><p>é˜»å¡é˜Ÿåˆ—æä¾›ä»¥ä¸‹<strong>4ç§å¤„ç†æ–¹æ³•</strong>ï¼š</p>
<p><img src="C:%5cUsers%5cwzt%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250108183136908.png"
	
	
	
	loading="lazy"
	
		alt="image-20250108183136908"
	
	
></p>
<h3 id="æŠ›å‡ºå¼‚å¸¸">æŠ›å‡ºå¼‚å¸¸
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">addæ­£å¸¸æ‰§è¡Œè¿”å›true
</span></span><span class="line"><span class="cl">elementï¼ˆä¸åˆ é™¤ï¼‰å’Œremoveï¼ˆåˆ é™¤ï¼‰è¿”å›é˜»å¡é˜Ÿåˆ—ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		å½“é˜»å¡é˜Ÿåˆ—æ»¡æ—¶ï¼Œå†å¾€é˜Ÿåˆ—é‡Œaddæ’å…¥å…ƒç´ ä¼šæŠ›IllegalStateException:Queue full
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">		å½“é˜»å¡é˜Ÿåˆ—ç©ºæ—¶ï¼Œå†ä»é˜Ÿåˆ—é‡Œremoveç§»é™¤å…ƒç´ ä¼šæŠ›NoSuchElementException
</span></span><span class="line"><span class="cl">		
</span></span><span class="line"><span class="cl">		å½“é˜»å¡é˜Ÿåˆ—ç©ºæ—¶ï¼Œå†è°ƒç”¨elementæ£€æŸ¥å…ƒç´ ä¼šæŠ›å‡ºNoSuchElementException
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ç‰¹æ®Šå€¼">ç‰¹æ®Šå€¼
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">æ’å…¥æ–¹æ³•ï¼ŒæˆåŠŸtureå¤±è´¥false
</span></span><span class="line"><span class="cl">ç§»é™¤æ–¹æ³•ï¼ŒæˆåŠŸè¿”å›å‡ºé˜Ÿåˆ—çš„å…ƒç´ ï¼Œé˜Ÿåˆ—é‡Œæ²¡æœ‰å°±è¿”å›null
</span></span><span class="line"><span class="cl">æ£€æŸ¥æ–¹æ³•ï¼ŒæˆåŠŸè¿”å›é˜Ÿåˆ—ä¸­çš„å…ƒç´ ï¼Œæ²¡æœ‰è¿”å›null
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="é˜»å¡">é˜»å¡
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">å¦‚æœè¯•å›¾çš„æ“ä½œæ— æ³•ç«‹å³æ‰§è¡Œï¼Œè¯¥æ–¹æ³•è°ƒç”¨å°†ä¼šå‘ç”Ÿé˜»å¡ï¼Œç›´åˆ°èƒ½å¤Ÿæ‰§è¡Œã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">å½“é˜»å¡é˜Ÿåˆ—æ»¡æ—¶ï¼Œå†å¾€é˜Ÿåˆ—é‡Œputå…ƒç´ ï¼Œé˜Ÿåˆ—ä¼šä¸€ç›´é˜»å¡ç”Ÿäº§è€…çº¿ç¨‹ï¼Œç›´åˆ°putæ•°æ®orå“åº”ä¸­æ–­é€€å‡º
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">å½“é˜»å¡é˜Ÿåˆ—ç©ºæ—¶ï¼Œå†ä»é˜Ÿåˆ—é‡Œtakeå…ƒç´ ï¼Œé˜Ÿåˆ—ä¼šä¸€ç›´é˜»å¡æ¶ˆè´¹è€…çº¿ç¨‹ï¼Œç›´åˆ°é˜Ÿåˆ—å¯ç”¨
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="è¶…æ—¶">è¶…æ—¶
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">å¦‚æœè¯•å›¾çš„æ“ä½œæ— æ³•ç«‹å³æ‰§è¡Œï¼Œè¯¥æ–¹æ³•è°ƒç”¨å°†ä¼šå‘ç”Ÿé˜»å¡ï¼Œç›´åˆ°èƒ½å¤Ÿæ‰§è¡Œï¼Œä½†ç­‰å¾…æ—¶é—´ä¸ä¼šè¶…è¿‡ç»™å®šå€¼ã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">è¿”å›ä¸€ä¸ªç‰¹å®šå€¼ä»¥å‘ŠçŸ¥è¯¥æ“ä½œæ˜¯å¦æˆåŠŸ(å…¸å‹çš„æ˜¯ true / false)ã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="é˜»å¡é˜Ÿåˆ—æ“ä½œ">é˜»å¡é˜Ÿåˆ—æ“ä½œ
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">BlockingQueueDemo</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">InterruptedException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//åˆ›å»ºæœ‰ç•Œé˜»å¡é˜Ÿåˆ— é˜Ÿåˆ—é•¿åº¦ä¸º3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">BlockingQueue</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">queue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayBlockingQueue</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">3</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// ç¬¬ä¸€ç»„æ–¹æ³•ï¼šadd remove element</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">queue</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&#34;a&#34;</span><span class="p">));</span><span class="w"> </span><span class="c1">//å…¥é˜Ÿ,æ­£å¸¸åˆ™è¿”å›true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">queue</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&#34;b&#34;</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">queue</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&#34;c&#34;</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// System.out.println(queue.add(&#34;d&#34;)); //é˜Ÿåˆ—å·²æ»¡ä»ç„¶å…¥é˜Ÿï¼ŒæŠ¥å¼‚å¸¸ IllegalStateExceptionå¼‚å¸¸</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">queue</span><span class="p">.</span><span class="na">element</span><span class="p">());</span><span class="w"> </span><span class="c1">//è·å–é˜Ÿåˆ—ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">queue</span><span class="p">.</span><span class="na">remove</span><span class="p">());</span><span class="w"> </span><span class="c1">//å‡ºé˜Ÿç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œè¿”å›å‡ºé˜Ÿå…ƒç´ </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">queue</span><span class="p">.</span><span class="na">remove</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">queue</span><span class="p">.</span><span class="na">remove</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//System.out.println(queue.remove()); //é˜Ÿåˆ—å·²ç©ºä»ç„¶å‡ºé˜Ÿï¼ŒæŠ¥å¼‚å¸¸ NoSuchElementException  æ²¡æœ‰è¿™æ ·çš„å…ƒç´ å¼‚å¸¸</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//System.out.println(queue.element()); //é˜Ÿåˆ—å·²ç©ºä»ç„¶è·å–å…ƒç´ ï¼ŒæŠ¥å¼‚å¸¸ NoSuchElementException æ²¡æœ‰è¿™æ ·çš„å…ƒç´ å¼‚å¸¸</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">-------------------------------------------------------</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// ç¬¬äºŒç»„ï¼šoffer poll peek</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="cm">/*System.out.println(queue.offer(&#34;a&#34;)); //å…¥é˜Ÿ,æ­£å¸¸åˆ™è¿”å›true
</span></span></span><span class="line"><span class="cl"><span class="cm">        System.out.println(queue.offer(&#34;b&#34;));
</span></span></span><span class="line"><span class="cl"><span class="cm">        System.out.println(queue.offer(&#34;c&#34;));
</span></span></span><span class="line"><span class="cl"><span class="cm">        System.out.println(queue.offer(&#34;d&#34;)); //é˜Ÿåˆ—å·²æ»¡ä»ç„¶å…¥é˜Ÿ, è¿”å›false
</span></span></span><span class="line"><span class="cl"><span class="cm">        System.out.println(queue.peek()); //è·å–é˜Ÿåˆ—ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›
</span></span></span><span class="line"><span class="cl"><span class="cm">        System.out.println(queue.poll()); //å‡ºé˜Ÿç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œè¿”å›å‡ºé˜Ÿå…ƒç´ 
</span></span></span><span class="line"><span class="cl"><span class="cm">        System.out.println(queue.poll());
</span></span></span><span class="line"><span class="cl"><span class="cm">        System.out.println(queue.poll());
</span></span></span><span class="line"><span class="cl"><span class="cm">        System.out.println(queue.poll()); //é˜Ÿåˆ—å·²ç©ºä»ç„¶å‡ºé˜Ÿï¼Œè¿”å›null
</span></span></span><span class="line"><span class="cl"><span class="cm">        System.out.println(queue.peek());  //é˜Ÿåˆ—å·²ç©ºä»ç„¶è·å–å…ƒç´ ï¼Œè¿”å›null*/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">---------------------------------------------------</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// ç¬¬ä¸‰ç»„ï¼šput take ************</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="cm">/*queue.put(&#34;a&#34;); //å…¥é˜Ÿ
</span></span></span><span class="line"><span class="cl"><span class="cm">        queue.put(&#34;b&#34;);
</span></span></span><span class="line"><span class="cl"><span class="cm">        queue.put(&#34;c&#34;);
</span></span></span><span class="line"><span class="cl"><span class="cm">        System.out.println(queue.take()); //å‡ºé˜Ÿç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œè¿”å›å‡ºé˜Ÿå…ƒç´ ï¼Œåˆ™åé¢ä»£ç ä¸ä¼šé˜»å¡
</span></span></span><span class="line"><span class="cl"><span class="cm">        queue.put(&#34;d&#34;); //é˜Ÿåˆ—å·²æ»¡ä»ç„¶å…¥é˜Ÿ, å‘ç”Ÿé˜»å¡
</span></span></span><span class="line"><span class="cl"><span class="cm">        System.out.println(queue.take()); //å‡ºé˜Ÿç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œè¿”å›å‡ºé˜Ÿå…ƒç´ 
</span></span></span><span class="line"><span class="cl"><span class="cm">        System.out.println(queue.take());
</span></span></span><span class="line"><span class="cl"><span class="cm">        System.out.println(queue.take());
</span></span></span><span class="line"><span class="cl"><span class="cm">        System.out.println(queue.take()); //é˜Ÿåˆ—å·²ç©ºä»ç„¶å‡ºé˜Ÿï¼Œå‘ç”Ÿé˜»å¡*/</span><span class="w">  </span><span class="n">é˜»å¡</span><span class="err">ï¼š</span><span class="n">ç¨‹åºæ²¡ç»ˆæ­¢</span><span class="err">ï¼Œ</span><span class="n">å¡ä½ä¸åŠ¨</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">----------------------------------------------------</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// ç¬¬å››ç»„ï¼šoffer poll</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="cm">/*System.out.println(queue.offer(&#34;a&#34;)); //å…¥é˜Ÿ,æ­£å¸¸åˆ™è¿”å›true
</span></span></span><span class="line"><span class="cl"><span class="cm">        System.out.println(queue.offer(&#34;b&#34;));
</span></span></span><span class="line"><span class="cl"><span class="cm">        System.out.println(queue.offer(&#34;c&#34;));
</span></span></span><span class="line"><span class="cl"><span class="cm">        System.out.println(queue.offer(&#34;d&#34;, 5, TimeUnit.SECONDS)); //é˜Ÿåˆ—å·²æ»¡ä»ç„¶å…¥é˜Ÿ,è¶…æ—¶è¿”å›false
</span></span></span><span class="line"><span class="cl"><span class="cm">        System.out.println(queue.poll()); //å‡ºé˜Ÿç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œè¿”å›å‡ºé˜Ÿå…ƒç´ 
</span></span></span><span class="line"><span class="cl"><span class="cm">        System.out.println(queue.poll());
</span></span></span><span class="line"><span class="cl"><span class="cm">        System.out.println(queue.poll());
</span></span></span><span class="line"><span class="cl"><span class="cm">        System.out.println(queue.poll(5, TimeUnit.SECONDS)); //é˜Ÿåˆ—å·²ç©ºä»ç„¶å‡ºé˜Ÿï¼Œ,è¶…æ—¶è¿”å›null*/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¡ˆä¾‹">ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¡ˆä¾‹
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">BlockingQueueDemo2</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//åˆ›å»ºæ— ç•Œé˜»å¡é˜Ÿåˆ—</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//BlockingQueue&lt;Integer&gt; queue = new LinkedBlockingDeque&lt;&gt;();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//åˆ›å»ºæœ‰ç•Œé˜»å¡é˜Ÿåˆ—ï¼šå½“æ¶ˆè´¹çš„è¿›åº¦è¾ƒæ…¢ï¼Œç”Ÿäº§è¿›åº¦è¾ƒå¿«ï¼Œè€Œä¸”é˜Ÿåˆ—æ”¾ä¸ä¸‹çš„æ—¶å€™ï¼Œç”Ÿäº§ä¼šè¢«è‡ªåŠ¨é˜»å¡ï¼Œç­‰å¾…æ¶ˆè´¹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">BlockingQueue</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span><span class="w"> </span><span class="n">queue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayBlockingQueue</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">3</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//ç”Ÿäº§è€…</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(()</span><span class="o">-&gt;</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">             </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                 </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">10</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                     </span><span class="n">queue</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">i</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                     </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;ç”Ÿäº§ç¬¬&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;ä¸ªé¦’å¤´ï¼Œ&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;ç›®å‰è¿˜å‰©&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">queue</span><span class="p">.</span><span class="na">size</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;ä¸ªé¦’å¤´&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                     </span><span class="n">TimeUnit</span><span class="p">.</span><span class="na">SECONDS</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="n">1</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                 </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">             </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InterruptedException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                 </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RuntimeException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">             </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="p">},</span><span class="w"> </span><span class="s">&#34;ç”Ÿäº§è€…&#34;</span><span class="p">).</span><span class="na">start</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//æ¶ˆè´¹è€…</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">Thread</span><span class="p">(()</span><span class="o">-&gt;</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">10</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;æ¶ˆè´¹ç¬¬&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">queue</span><span class="p">.</span><span class="na">take</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;ä¸ªé¦’å¤´&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;ç›®å‰è¿˜å‰©&#34;</span><span class="w"> </span><span class="o">+</span><span class="n">queue</span><span class="p">.</span><span class="na">size</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;ä¸ªé¦’å¤´&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">TimeUnit</span><span class="p">.</span><span class="na">SECONDS</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="n">3</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InterruptedException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RuntimeException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">},</span><span class="w"> </span><span class="s">&#34;æ¶ˆè´¹è€…&#34;</span><span class="p">).</span><span class="na">start</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="synchronousqueue">SynchronousQueue
</h3><p>ä½œç”¨åœºæ™¯ï¼šç”Ÿäº§å¹¶ç›´æ¥äº¤ä»˜</p>
<p>è¯¦æƒ…çœ‹ç¬”è®°</p>
<h2 id="çº¿ç¨‹æ± ">çº¿ç¨‹æ± 
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">å¼‚æ­¥è°ƒç”¨ï¼šåšä¸€äº›è¿œç¨‹è°ƒç”¨ï¼Œå¾®æœåŠ¡è°ƒç”¨ï¼Œè¿™ä¸ªæ—¶å€™éœ€è¦åˆ›å»ºçº¿ç¨‹æ± ï¼Œé€šè¿‡çº¿ç¨‹æ± æ¥æ‰§è¡Œè¿œç¨‹è°ƒç”¨ã€‚ 
</span></span><span class="line"><span class="cl">     å¼‚æ­¥æ–¹å¼è¿›è¡Œè¿œç¨‹è°ƒç”¨ï¼š
</span></span><span class="line"><span class="cl">     6ä¸ªè¿œç¨‹æ¥å£æ²¡æœ‰ä¸šåŠ¡ä¸Šå…ˆåé¡ºåºçš„è¦æ±‚ï¼Œå¯ä»¥6ä¸ªè¯·æ±‚ä¸€èµ·å‘é€ï¼Œ6ä¸ªç»“æœä¸€èµ·å›æ¥ï¼Œç„¶åç»„è£…æ•°æ®ï¼Œè¿”å›å‰ç«¯
</span></span><span class="line"><span class="cl">     exï¼š1s  ä½†åŒæ­¥ï¼š6s
</span></span></code></pre></td></tr></table>
</div>
</div><p>çº¿ç¨‹æ± æ˜¯é€šè¿‡Executoræ¡†æ¶å®ç°çš„</p>
<p>è¯¥æ¡†æ¶ç”¨äº†</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">Executor</span><span class="err">ï¼š</span><span class="n">execute</span><span class="p">(</span><span class="n">runnable</span><span class="w"> </span><span class="n">command</span><span class="p">)</span><span class="n">æ‰§è¡Œä»»åŠ¡çš„æ–¹æ³•</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">ExecutorService</span><span class="err">ï¼š</span><span class="n">ç»§æ‰¿Executor</span><span class="w">  </span><span class="n">submit</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">ThreadPoolExecutor</span><span class="err">ï¼š</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="çº¿ç¨‹æ± æ¡†æ¶">çº¿ç¨‹æ± æ¡†æ¶
</h3><p><img src="C:%5cUsers%5cwzt%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250108212314304.png"
	
	
	
	loading="lazy"
	
		alt="image-20250108212314304"
	
	
></p>
<p><strong>åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ± å¯¹è±¡</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">é€šå¸¸ä½¿ç”¨Executorså·¥å…·ç±»
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>é¢è¯•é¢˜ï¼šexecuteå’Œsubmitçš„åŒºåˆ«</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">1. executeæ˜¯Executoræ¥å£çš„æ–¹æ³•ã€‚
</span></span><span class="line"><span class="cl">   submitæ˜¯ExecutorServiceçš„æ–¹æ³•
</span></span><span class="line"><span class="cl">   ExecutorServiceæ¥å£ç»§æ‰¿äº†Executoræ¥å£ã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">2. executeåªæ¥å—Runnableå‚æ•°
</span></span><span class="line"><span class="cl">   æ²¡æœ‰è¿”å›å€¼ 
</span></span><span class="line"><span class="cl">   submitå¯ä»¥æ¥å—Runnableå‚æ•°å’ŒCallableå‚æ•°
</span></span><span class="line"><span class="cl">   è¿”å›äº†Futureå¯¹è±¡ï¼Œå¯ä»¥è¿›è¡Œä»»åŠ¡å–æ¶ˆã€è·å–ä»»åŠ¡ç»“æœã€åˆ¤æ–­ä»»åŠ¡æ˜¯å¦æ‰§è¡Œå®Œæ¯•/å–æ¶ˆç­‰æ“ä½œã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">3. é€šè¿‡executeæ–¹æ³•æäº¤çš„ä»»åŠ¡æ— æ³•è·å–å…·ä½“çš„å¼‚å¸¸ä¿¡æ¯ï¼›
</span></span><span class="line"><span class="cl">      submitæ–¹æ³•å¯ä»¥é€šè¿‡Futureå¯¹è±¡è·å–å¼‚å¸¸ä¿¡æ¯ã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="executorsç¦ç”¨">Executors(ç¦ç”¨)
</h3><p><img src="C:%5cUsers%5cwzt%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250108212707893.png"
	
	
	
	loading="lazy"
	
		alt="image-20250108212707893"
	
	
></p>
<p><img src="C:%5cUsers%5cwzt%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250108212836879.png"
	
	
	
	loading="lazy"
	
		alt="image-20250108212836879"
	
	
></p>
<h3 id="çº¿ç¨‹æ± å·¥ä½œåŸç†">çº¿ç¨‹æ± å·¥ä½œåŸç†
</h3><h4 id="å¦‚ä½•åˆ›å»ºçº¿ç¨‹æ± ">å¦‚ä½•åˆ›å»ºçº¿ç¨‹æ± ï¼Ÿ
</h4><p>â€‹    ä½¿ç”¨Executorså·¥å‚
â€‹    ä½¿ç”¨ThreadPoolExecutoræ„é€ å‡½æ•°</p>
<h4 id="7ä¸ªå‚æ•°">7ä¸ªå‚æ•°
</h4><pre><code>ThreadPoolExecutorçš„ä¸ƒä¸ªå‚æ•°:
corePoolSizeï¼ˆæ ¸å¿ƒæ± å¤§å°ï¼‰ä¸ä¼šè¢«å›æ”¶
maximumPoolSizeï¼ˆæœ€å¤§æ± å¤§å°ï¼‰ä¼šè¢«å›æ”¶
keepAliveTimeï¼ˆçº¿ç¨‹ç©ºé—²å­˜æ´»æ—¶é—´ï¼‰
unitï¼ˆæ—¶é—´å•ä½ï¼‰
workQueueï¼ˆå·¥ä½œé˜Ÿåˆ—ï¼‰
		LinkedBlockingQueueå¤§å°æ— é™åˆ¶
		ArrayBlockingQueueå¤§å°æœ‰é™ï¼Œå¿…é¡»æŒ‡å®šå®¹é‡
		SynchronousQueueä¸å­˜å‚¨ä»»åŠ¡,ç›´æ¥ç»™çº¿ç¨‹æ± 
threadFactoryï¼ˆçº¿ç¨‹å·¥å‚ï¼‰
handlerï¼ˆæ‹’ç»ç­–ç•¥ï¼‰
		AbortPolicy: ç›´æ¥æŠ›å‡ºå¼‚å¸¸
		CallerRunsPolicyï¼šè¿”å›ç»™è°ƒç”¨è€…çº¿ç¨‹æ‰§è¡Œè¯¥ä»»åŠ¡
		DiscardPolicyï¼šç›´æ¥ä¸¢å¼ƒè¯¥ä»»åŠ¡
		DiscardOldestPolicyï¼šä¸¢å¼ƒæœ€æ—§çš„ä¸€ä¸ªä»»åŠ¡
</code></pre>
<p><img src="C:%5cUsers%5cwzt%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250108213032765.png"
	
	
	
	loading="lazy"
	
		alt="image-20250108213032765"
	
	
></p>
<h4 id="çº¿ç¨‹æ± å·¥ä½œåŸç†-1">çº¿ç¨‹æ± å·¥ä½œåŸç†
</h4><p><img src="C:%5cUsers%5cwzt%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250108212951920.png"
	
	
	
	loading="lazy"
	
		alt="image-20250108212951920"
	
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">å·¥ä½œåŸç†:
</span></span><span class="line"><span class="cl">	æäº¤æ–°ä»»åŠ¡æ—¶,çº¿ç¨‹æ± è¿›è¡Œåˆ¤æ–­æ˜¯å¦æœ‰ç©ºé—²çº¿ç¨‹,æœ‰å°±ç›´æ¥æ‰§è¡Œ,æ²¡æœ‰å°±æŸ¥çœ‹æ˜¯å¦åˆ°è¾¾æ ¸å¿ƒçº¿ç¨‹æ•°,æ²¡æœ‰å°±åˆ›å»ºæ–°çš„çº¿ç¨‹æ‰§è¡Œ,
</span></span><span class="line"><span class="cl">	å¦‚æœè¾¾åˆ°æ ¸å¿ƒçº¿ç¨‹æ•°ä½†ä»»åŠ¡é˜Ÿåˆ—æœ‰ç©ºé—´,è¿›å…¥ä»»åŠ¡é˜Ÿåˆ—,
</span></span><span class="line"><span class="cl">	å¦‚æœä»»åŠ¡é˜Ÿåˆ—ä¹Ÿå·²ç»æ»¡äº†,æŸ¥çœ‹æ˜¯å¦åˆ°è¾¾æœ€å¤§çº¿ç¨‹æ•°,æ²¡æœ‰åˆ°è¾¾æœ€å¤§çº¿ç¨‹æ•°å°±åˆ›å»ºæ–°çš„çº¿ç¨‹,è‹¥åˆ°è¾¾æœ€å¤§çº¿ç¨‹æ•°,æ‰§è¡Œæ‹’ç»ç­–ç•¥
</span></span><span class="line"><span class="cl">	å½“é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡æ‰§è¡Œå®Œ,çº¿ç¨‹ç©ºé—²æ—¶é—´åˆ°è¾¾é¢„è®¾æ—¶é—´,é”€æ¯è¶…å‡ºæ ¸å¿ƒçº¿ç¨‹æ•°çš„çº¿ç¨‹
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">è™½ç„¶ä¹Ÿæ˜¯æœ‰è¯·æ±‚å°±åˆ›å»ºï¼Œä½†å®ƒä¼šåˆ¤æ–­ï¼Œå¦‚æœæ»¡äº†å°±å»åˆ¤æ–­ä»»åŠ¡é˜Ÿåˆ—ï¼Œä»»åŠ¡é˜Ÿåˆ—å¦‚æœæ»¡äº†ä¼šå–åˆ¤æ–­æœ€å¤§çº¿ç¨‹æ± ï¼Œæœ€åè¿˜æ˜¯ä¸å¤Ÿä¼šäº¤ç»™æ‹’ç»ç­–ç•¥å¤„ç†
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">å¹¶ä¸æ˜¯æ— æ‰€èŠ‚åˆ¶çš„åˆ›å»ºçº¿ç¨‹**
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">æœ€å¤§çº¿ç¨‹æ•°åŒ…æ‹¬æ ¸å¿ƒçº¿ç¨‹æ•°
</span></span><span class="line"><span class="cl">æ³¨æ„ï¼Œé˜Ÿåˆ—è‹¥æ»¡ï¼Œæœ€å¤§çº¿ç¨‹æ•°æœ‰ç©ºï¼Œä¼šç›´æ¥åˆ›å»ºæ–°çº¿ç¨‹æ‰§è¡Œï¼Œå¹¶ä¸ä¼šè®©å¯¹å¤´å‡ºé˜Ÿ
</span></span><span class="line"><span class="cl">æ¯”å¦‚13æ¥äº†ï¼Œå»åˆ›å»º13çš„
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºè¿™æ ·æ¯”å‡ºé˜Ÿç›¸ç‡æ›´é«˜
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="C:%5cUsers%5cwzt%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250108213131757.png"
	
	
	
	loading="lazy"
	
		alt="image-20250108213131757"
	
	
></p>
<h4 id="æ‹’ç»ç­–ç•¥">æ‹’ç»ç­–ç•¥
</h4><p><img src="C:%5cUsers%5cwzt%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250108213245053.png"
	
	
	
	loading="lazy"
	
		alt="image-20250108213245053"
	
	
></p>
<p>ä»¥ä¸Šå†…ç½®çš„ç­–ç•¥å‡å®ç°äº†RejectedExecutionHandleræ¥å£ï¼Œ<code>ä¹Ÿå¯ä»¥è‡ªå·±æ‰©å±•RejectedExecutionHandleræ¥å£</code>ï¼Œå®šä¹‰è‡ªå·±çš„æ‹’ç»ç­–ç•¥</p>
<p>å®é™…ä¸šåŠ¡å“ªä¸ªéƒ½åŸºæœ¬ä¸ç”¨ï¼Œæœ€å¸¸ç”¨çš„æ˜¯è‡ªå®šä¹‰æ‹’ç»ç­–ç•¥ï¼ˆçº¿ç¨‹ç¡ä¸€è§‰ç­‰è‡ªå®šä¹‰é¥±å’Œæ‹’ç»ç­–ç•¥ï¼‰</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">å­˜å‚¨ä»»åŠ¡ï¼Œå°†æ¥äººå·¥å¤„ç†
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">å‘é‚®ä»¶ã€å‘çŸ­ä¿¡è­¦å‘Š
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ç¡ä¸€ä¼šï¼Œå†æ¬¡å°†ä»»åŠ¡æäº¤çº¿ç¨‹æ± å¤„ç†
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ç­‰ç­‰ç­‰
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="è‡ªå®šä¹‰çº¿ç¨‹æ± ">è‡ªå®šä¹‰çº¿ç¨‹æ± 
</h3><p><img src="C:%5cUsers%5cwzt%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250108213428558.png"
	
	
	
	loading="lazy"
	
		alt="image-20250108213428558"
	
	
></p>
<p>æ¡ˆä¾‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span><span class="w"> </span><span class="nn">com.atguigu.demojuc.chap08</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">class</span> <span class="nc">MyRunnable</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">Runnable</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">param</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">MyRunnable</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">param</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">param</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">param</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">  </span><span class="s">&#34; Runnable......&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">param</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">CustomizeThreadPoolDemo</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">// è‡ªå®šä¹‰è¿æ¥æ± </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">ExecutorService</span><span class="w"> </span><span class="n">threadPool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">2</span><span class="p">,</span><span class="c1">//æ ¸å¿ƒçº¿ç¨‹æ•°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">5</span><span class="p">,</span><span class="c1">//æœ€å¤§çº¿ç¨‹æ•°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">2</span><span class="p">,</span><span class="c1">//ç­‰å¾…ç©ºé—²æ—¶é—´ï¼Œæ—¶é—´åˆ°è¾¾ä¼šé”€æ¯éæ ¸å¿ƒçº¿ç¨‹æ•°ã€‚æ ¸å¿ƒçº¿ç¨‹ä¸é”€æ¯    0å°±æ˜¯ä¸é”€æ¯</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">TimeUnit</span><span class="p">.</span><span class="na">SECONDS</span><span class="p">,</span><span class="c1">//æ—¶é—´å•ä½</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayBlockingQueue</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">3</span><span class="p">),</span><span class="c1">//ä»»åŠ¡ç­‰å¾…é˜Ÿåˆ—</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">Executors</span><span class="p">.</span><span class="na">defaultThreadFactory</span><span class="p">(),</span><span class="c1">//çº¿ç¨‹å·¥å‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">new</span><span class="w"> </span><span class="n">ThreadPoolExecutor</span><span class="p">.</span><span class="na">AbortPolicy</span><span class="p">()</span><span class="w"> </span><span class="c1">//é¥±å’Œæ‹’ç»ç­–ç•¥</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//ä¸¢å¼ƒä»»åŠ¡å¹¶æŠ›å‡ºå¼‚å¸¸</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="c1">//new ThreadPoolExecutor.CallerRunsPolicy() //ç”±è°ƒç”¨çº¿ç¨‹å¤„ç†è¯¥ä»»åŠ¡ï¼Œè°è°ƒç”¨è°å¤„ç†</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="c1">//new ThreadPoolExecutor.DiscardOldestPolicy() //ä¸¢å¼ƒé˜Ÿåˆ—ä¸­ç­‰å¾…æœ€ä¹…çš„ä»»åŠ¡ï¼Œæ·»åŠ æ–°ä»»åŠ¡</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="c1">//new ThreadPoolExecutor.DiscardPolicy() //ä¹Ÿæ˜¯ä¸¢å¼ƒä»»åŠ¡ï¼Œä½†æ˜¯ä¸æŠ›å‡ºå¼‚å¸¸ã€‚ </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="cm">/*new RejectedExecutionHandler() {
</span></span></span><span class="line"><span class="cl"><span class="cm">                    @Override
</span></span></span><span class="line"><span class="cl"><span class="cm">                    public void rejectedExecution(Runnable r, ThreadPoolExecutor executor) {
</span></span></span><span class="line"><span class="cl"><span class="cm">                        System.out.println(&#34;è‡ªå®šä¹‰æ‹’ç»ç­–ç•¥&#34;);
</span></span></span><span class="line"><span class="cl"><span class="cm">                    }
</span></span></span><span class="line"><span class="cl"><span class="cm">                }*/</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">9</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="c1">//execute()æ–¹æ³•åªèƒ½æ¥æ”¶Runnableå‚æ•°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="n">threadPool</span><span class="p">.</span><span class="na">execute</span><span class="p">(()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="c1">//submit()æ–¹æ³•å¯ä»¥æ¥æ”¶Runnableæˆ–Callable æ¨è</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="c1">//threadPool.submit(() -&gt; { //è¿™é‡Œä¹Ÿå¯ä»¥ä½¿ç”¨submit</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;æ‰§è¡Œäº†ä¸šåŠ¡é€»è¾‘&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="p">});</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">finally</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">threadPool</span><span class="p">.</span><span class="na">shutdown</span><span class="p">();</span><span class="c1">//å…³é—­çº¿ç¨‹æ± ï¼Œä½†å®é™…ä¸šåŠ¡åŸºæœ¬ä¸å…³</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="æ€»ç»“">æ€»ç»“
</h3><p>çº¿ç¨‹æ± ä¸»è¦ä½œç”¨ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">æœ‰æ•ˆåœ°ç®¡ç†å’Œå¤ç”¨çº¿ç¨‹ï¼Œä»¥æé«˜å¤šçº¿ç¨‹åº”ç”¨ç¨‹åºçš„æ€§èƒ½å’Œèµ„æºåˆ©ç”¨ç‡ã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¼˜ç‚¹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">1</span><span class="p">.</span><span class="w"> </span><span class="n">çº¿ç¨‹å¤ç”¨</span><span class="err">ï¼š</span><span class="n">çº¿ç¨‹æ± ä¼šåœ¨æ± ä¸­ç»´æŠ¤ä¸€ç»„å¯é‡ç”¨çš„çº¿ç¨‹</span><span class="err">ï¼Œ</span><span class="n">è¿™äº›çº¿ç¨‹å¯ä»¥åå¤æ‰§è¡Œä»»åŠ¡</span><span class="err">ã€‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">çº¿ç¨‹çš„å¤ç”¨å‡å°‘äº†çº¿ç¨‹åˆ›å»ºå’Œé”€æ¯çš„å¼€é”€</span><span class="err">ï¼Œ</span><span class="n">æé«˜äº†æ‰§è¡Œä»»åŠ¡çš„æ•ˆç‡</span><span class="err">ã€‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//---------------------------</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">2</span><span class="p">.</span><span class="w"> </span><span class="n">ä»»åŠ¡é˜Ÿåˆ—</span><span class="err">ï¼š</span><span class="n">çº¿ç¨‹æ± é€šå¸¸ä¸ä»»åŠ¡é˜Ÿåˆ—ç»“åˆä½¿ç”¨</span><span class="err">ï¼Œ</span><span class="n">å°†å¾…æ‰§è¡Œçš„ä»»åŠ¡æ’é˜Ÿç­‰å¾…æ‰§è¡Œ</span><span class="err">ã€‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">è¿™å…è®¸ä»»åŠ¡æŒ‰é¡ºåºæ‰§è¡Œ</span><span class="err">ï¼Œ</span><span class="n">æ§åˆ¶å¹¶å‘åº¦</span><span class="err">ï¼Œ</span><span class="n">é˜²æ­¢ä»»åŠ¡è¿‡å¤šå¯¼è‡´èµ„æºè€—å°½</span><span class="err">ã€‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//-------------------------</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">3</span><span class="p">.</span><span class="w"> </span><span class="n">çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸç®¡ç†</span><span class="err">ï¼š</span><span class="n">çº¿ç¨‹æ± å¯ä»¥ç®¡ç†çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ</span><span class="err">ï¼Œ</span><span class="n">åŒ…æ‹¬çº¿ç¨‹çš„åˆ›å»º</span><span class="err">ã€</span><span class="n">é”€æ¯</span><span class="err">ã€</span><span class="n">è¶…æ—¶å¤„ç†ç­‰</span><span class="err">ã€‚</span><span class="p">(</span><span class="n">çº¿ç¨‹å·¥å‚ç®¡çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸç®¡ç†</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">è¿™æœ‰åŠ©äºå‡å°‘èµ„æºæ³„æ¼å’Œæé«˜ç³»ç»Ÿçš„ç¨³å®šæ€§</span><span class="err">ã€‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//----------------------------</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">4</span><span class="p">.</span><span class="w"> </span><span class="n">å¯æ§æ€§</span><span class="err">ï¼š</span><span class="n">çº¿ç¨‹æ± å…è®¸æ‚¨æ§åˆ¶çº¿ç¨‹çš„æ•°é‡</span><span class="err">ã€</span><span class="n">æœ€å¤§å¹¶å‘æ•°</span><span class="err">ã€</span><span class="n">çº¿ç¨‹ä¼˜å…ˆçº§ç­‰å‚æ•°</span><span class="err">ï¼Œ</span><span class="n">ä»¥æ»¡è¶³ä¸åŒåº”ç”¨åœºæ™¯çš„éœ€æ±‚</span><span class="err">ã€‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="n">å¼¹æ€§ä¼¸ç¼©</span><span class="err">ï¼Œ</span><span class="n">å°‘äº†</span><span class="o">--&gt;</span><span class="n">æœ€å°</span><span class="w">  </span><span class="n">å¤šäº†</span><span class="o">--&gt;</span><span class="n">æœ€å¤§</span><span class="err">ï¼Œ</span><span class="n">å†å¤šå°±æ‹’ç»ç­–ç•¥å¤„ç†</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="å¤šçº¿ç¨‹é«˜å¹¶å‘åº•å±‚åŸç†">å¤šçº¿ç¨‹é«˜å¹¶å‘åº•å±‚åŸç†
</h2><h3 id="javaå†…å­˜æ¨¡å‹jmm">Javaå†…å­˜æ¨¡å‹(JMM)
</h3><p>è®¡ç®—æœºç¡¬ä»¶</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">CPU é€šè¿‡CPUç¼“å­˜å’ŒCPUå¯„å­˜å™¨æ¥æé«˜æ•°æ®è®¿é—®é€Ÿåº¦ï¼Œå‡å°‘å¯¹RAMçš„è®¿é—®æ¬¡æ•°ï¼Œæé«˜å¯¹RAMçš„è®¿é—®æ•ˆç‡ï¼Œä»è€Œæé«˜è®¡ç®—æœºçš„æ€§èƒ½ã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ï¼ˆROMåªè¯»ä¸èƒ½å†™ï¼‰
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ï¼ˆRAMéšæœºå­˜å–å­˜å‚¨å™¨ èƒ½è¯»èƒ½å†™ï¼‰
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">     JMMå±è”½äº†å±è”½ç³»ç»Ÿå’Œç¡¬ä»¶çš„å·®å¼‚
</span></span><span class="line"><span class="cl">     æ•…javaä¸€æ¬¡ç¼–è¯‘åˆ°å¤„è¿è¡Œ
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<p>JMMè§„å®šäº†å†…å­˜ä¸»è¦åˆ’åˆ†ä¸º<strong>ä¸»å†…å­˜</strong>å’Œ<strong>å·¥ä½œå†…å­˜</strong>ä¸¤ç§ã€‚</p>
<p><strong>ä¸»å†…å­˜å¯¹åº”çš„æ˜¯ç¡¬ä»¶çš„ç‰©ç†å†…å­˜</strong></p>
<p><strong>å·¥ä½œå†…å­˜å¯¹åº”çš„æ˜¯å¯„å­˜å™¨å’Œé«˜é€Ÿç¼“å­˜</strong>ã€‚</p>
<p><img src="C:%5cUsers%5cwzt%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250108184630629.png"
	
	
	
	loading="lazy"
	
		alt="image-20250108184630629"
	
	
></p>
<ul>
<li>
<p><strong>å…±äº«å˜é‡</strong>ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">å¦‚æœä¸€ä¸ªå˜é‡è¢«å¤šä¸ªçº¿ç¨‹ä½¿ç”¨ï¼Œé‚£ä¹ˆè¿™ä¸ªå˜é‡ä¼šåœ¨æ¯ä¸ªçº¿ç¨‹çš„å·¥ä½œå†…å­˜ä¸­ä¿æœ‰ä¸€ä¸ªå‰¯æœ¬ï¼Œè¿™ç§å˜é‡å°±æ˜¯å…±äº«å˜é‡ã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">æ•°æ®æ”¾ä¸»å†…å­˜ä¸­ï¼Œä¸ºä»€ä¹ˆæ˜¯å…±äº«ï¼š
</span></span><span class="line"><span class="cl">å› ä¸ºæ•°æ®è¢«å¤šä¸ªçº¿ç¨‹å…±äº«
</span></span><span class="line"><span class="cl">ä½†æ˜¯å› ä¸ºå†™æ“ä½œæ— æ³•å¹¶å‘ï¼Œ
</span></span><span class="line"><span class="cl">æ•…çº¿ç¨‹è¦æ“ä½œå…±äº«å˜é‡ï¼Œä¼šå°†å…±äº«å˜é‡æ‹·è´ä¸€ä»½ï¼Œæ”¾åˆ°å½“å‰çº¿ç¨‹çš„æœ¬åœ°å†…å­˜å½“ä¸­æ¥è¿›è¡Œæ•°æ®çš„å¤„ç†
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">æ•°æ®æ”¹äº†åå†å†™å›ä¸»å†…å­˜ï¼Œè¿™å«åšæ•°æ®çš„åŒæ­¥
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong>ä¸»å†…å­˜</strong>ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ä¿å­˜äº†æ‰€æœ‰çš„å…±äº«å˜é‡ã€‚
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong>å·¥ä½œå†…å­˜</strong>ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„å·¥ä½œå†…å­˜ï¼Œçº¿ç¨‹ç‹¬äº«ï¼Œä¿å­˜äº†çº¿ç¨‹ç”¨åˆ°çš„å˜é‡å‰¯æœ¬ï¼ˆä¸»å†…å­˜å…±äº«å˜é‡çš„ä¸€ä»½æ‹·è´ï¼‰ã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>JMM</strong>å¯¹å…±äº«å†…å­˜çš„æ“ä½œåšå‡ºäº†å¦‚ä¸‹ä¸¤æ¡è§„å®šï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">- çº¿ç¨‹å¯¹å…±äº«å†…å­˜çš„æ‰€æœ‰æ“ä½œéƒ½å¿…é¡»åœ¨è‡ªå·±çš„å·¥ä½œå†…å­˜ä¸­è¿›è¡Œï¼Œä¸èƒ½ç›´æ¥ä»ä¸»å†…å­˜ä¸­è¯»å†™ï¼›
</span></span><span class="line"><span class="cl">æ•°æ®æ”¹äº†åå†å†™å›ä¸»å†…å­˜ï¼Œè¿™å«åšæ•°æ®çš„åŒæ­¥
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">- ä¸åŒçº¿ç¨‹æ— æ³•ç›´æ¥è®¿é—®å…¶ä»–çº¿ç¨‹å·¥ä½œå†…å­˜ä¸­çš„å˜é‡ï¼Œå› æ­¤å…±äº«å˜é‡çš„å€¼ä¼ é€’éœ€è¦é€šè¿‡ä¸»å†…å­˜å®Œæˆã€‚
</span></span><span class="line"><span class="cl">åªæœ‰å°†æ”¹åæ•°æ®å†™å›åˆ°ä¸»å†…å­˜ä¸­ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹å°†å…¶ä»ä¸»å†…å­˜ä¸­è¯»èµ°æ‰èƒ½è·å¾—æœ€æ–°æ•°æ®
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<p>avaå†…å­˜æ¨¡å‹çš„ä¸‰å¤§ç‰¹æ€§</p>
<ul>
<li>å¯è§æ€§</li>
<li>æœ‰åºæ€§</li>
<li>åŸå­æ€§</li>
</ul>
<h3 id="volatileå…³é”®å­—">volatileå…³é”®å­—
</h3><h4 id="å¯è§æ€§">å¯è§æ€§
</h4><p><img src="C:%5cUsers%5cwzt%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250108190158199.png"
	
	
	
	loading="lazy"
	
		alt="image-20250108190158199"
	
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ä½¿ç”¨volatileå…³é”®å­—å¯ä»¥ç¡®ä¿å…±äº«å˜é‡çš„å¯è§æ€§
</span></span><span class="line"><span class="cl">å½“ä¸€ä¸ªå˜é‡è¢«å£°æ˜ä¸ºvolatileæ—¶
</span></span><span class="line"><span class="cl">           æ¯æ¬¡è®¿é—®è¯¥å˜é‡æ—¶éƒ½ä¼šä»ä¸»å†…å­˜ä¸­è¯»å–æœ€æ–°çš„å€¼
</span></span><span class="line"><span class="cl">           å¹¶ä¸”å¯¹è¯¥å˜é‡çš„ä¿®æ”¹ä¼šç«‹å³å†™å…¥ä¸»å†…å­˜ï¼Œè€Œä¸æ˜¯å…ˆå†™å…¥ç¼“å­˜
</span></span><span class="line"><span class="cl">           
</span></span><span class="line"><span class="cl">é¿å…äº†åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹å‡ºç°æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜
</span></span><span class="line"><span class="cl">å› ä¸ºä»»ä½•å¯¹volatileå˜é‡çš„ä¿®æ”¹éƒ½ä¼šç«‹å³å¯è§äºå…¶ä»–çº¿ç¨‹
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="æœ‰åºæ€§">æœ‰åºæ€§
</h4><p><img src="C:%5cUsers%5cwzt%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250108190550432.png"
	
	
	
	loading="lazy"
	
		alt="image-20250108190550432"
	
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">å°†å˜é‡å£°æ˜ä¸ºvolatile
</span></span><span class="line"><span class="cl">å¯ä»¥é¿å…æŒ‡ä»¤é‡æ’çš„ä¼˜åŒ–æœºåˆ¶ï¼Œä¿è¯æŒ‡ä»¤çš„æ‰§è¡Œé¡ºåºä¸æºä»£ç ä¸­çš„é¡ºåºä¸€è‡´
</span></span><span class="line"><span class="cl">ä»¥é¿å…å¤šçº¿ç¨‹ç¯å¢ƒä¸‹çš„é”™è¯¯
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="åŸå­æ€§">åŸå­æ€§
</h4><p>ä»0åˆ°1000</p>
<p>1000ä¸ªçº¿ç¨‹æ‰§è¡Œ++numberæ“ä½œï¼Œå¦‚æœ++numberæ“ä½œå…·å¤‡åŸå­æ€§ï¼Œæœ€åçš„å€¼åº”è¯¥æ˜¯1000ã€‚è¯´æ˜++number<strong>ä¸å…·å¤‡åŸå­æ€§</strong>ã€‚</p>
<p>ç»™numberæ·»åŠ volatileå…³é”®å­—</p>
<p>æµ‹è¯•ç»“æœä¾ç„¶ä¸æ˜¯1000</p>
<p>å°è¯•ç»™++numberæ–¹æ³•åŠ åŒæ­¥é”</p>
<p>ç»“æœè¾¾æˆ</p>
<p><strong>è¯´æ˜volatileå…³é”®å­—ä¸èƒ½ä¿è¯åŸå­æ€§ã€‚</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">volatileå…³é”®å­—åªèƒ½ä¿è¯å•ä¸ªå˜é‡çš„å¯è§æ€§ï¼Œå¹¶ä¸èƒ½è§£å†³åŸå­æ€§é—®é¢˜ã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">å¯¹äºåŸå­æ€§éœ€æ±‚ï¼Œéœ€è¦ä½¿ç”¨æ›´å¼ºå¤§çš„åŒæ­¥æœºåˆ¶ï¼Œå¦‚é”ã€åŸå­æ“ä½œç­‰ã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="ä¿è¯ä¸‰å¤§ç‰¹æ€§">ä¿è¯ä¸‰å¤§ç‰¹æ€§
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">å¯è§æ€§ï¼š
</span></span><span class="line"><span class="cl">       ä½¿ç”¨volatileå…³é”®å­—å£°æ˜å˜é‡ï¼Œç¡®ä¿ä¿®æ”¹å¯¹äºæ‰€æœ‰çº¿ç¨‹ç«‹å³å¯è§
</span></span><span class="line"><span class="cl">       
</span></span><span class="line"><span class="cl">æœ‰åºæ€§ï¼š
</span></span><span class="line"><span class="cl">       volatileä¿è¯å¯¹è¯¥å˜é‡çš„è¯»å†™æ“ä½œæ˜¯æœ‰åºçš„ï¼Œç¦æ­¢é‡æ’åº
</span></span><span class="line"><span class="cl">åŸå­æ€§ï¼š
</span></span><span class="line"><span class="cl">      synchronizedåŒæ­¥é”ç¡®ä¿å¯¹å…±äº«å˜é‡çš„æ“ä½œæ˜¯åŸå­çš„
</span></span><span class="line"><span class="cl">      atomicæä¾›çš„åŸå­ç±»AtomicIntegerã€AtomicLongç­‰
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="cas">CAS
</h3><h3 id="aqs">AQS
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">AbstractQueuedSynchronizeræŠ½è±¡é˜Ÿåˆ—åŒæ­¥å™¨ç®€ç§°AQS</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">æ˜¯æ•´ä¸ªjava</span><span class="p">.</span><span class="na">util</span><span class="p">.</span><span class="na">concurrentåŒ…çš„æ ¸å¿ƒ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">AQSæ¡†æ¶æä¾›äº†ä¸€å¥—é€šç”¨çš„æœºåˆ¶æ¥</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">ç®¡ç†åŒæ­¥çŠ¶æ€</span><span class="err">ï¼ˆ</span><span class="n">synchronization</span><span class="w"> </span><span class="n">state</span><span class="err">ï¼‰ã€</span><span class="n">é˜»å¡</span><span class="o">/</span><span class="n">å”¤é†’çº¿ç¨‹</span><span class="err">ã€</span><span class="n">ç®¡ç†ç­‰å¾…é˜Ÿåˆ—</span><span class="err">ã€‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">JUCä¸‹çš„Lock</span><span class="err">ï¼ˆ</span><span class="n">ReentrantLock</span><span class="err">ã€</span><span class="n">ReentrantReadWriteLockç­‰</span><span class="err">ï¼‰</span><span class="n">ä»¥åŠå¹¶å‘å·¥å…·ç±»</span><span class="err">ï¼ˆ</span><span class="n">Semaphore</span><span class="err">ã€</span><span class="n">CountDownLatch</span><span class="err">ã€</span><span class="n">CyclicBarrierç­‰</span><span class="err">ï¼‰</span><span class="n">å°±æ˜¯é€šè¿‡AQSå®ç°çš„</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="ä»€ä¹ˆæ˜¯aqs"><strong>ä»€ä¹ˆæ˜¯AQS</strong>
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ä¸€ä¸ªçŠ¶æ€å€¼+åŒç«¯é˜Ÿåˆ—(FIFO)ï¼ˆå·¦è¿›å³å‡ºï¼Œå³è¿›å·¦å‡ºï¼‰
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">- FIFOï¼šæ„å‘³ç€ç­‰å¾…æ—¶é—´æœ€é•¿çš„çº¿ç¨‹å°†é¦–å…ˆè·å¾—é”æˆ–èµ„æºï¼ˆå…¬å¹³é”æ’é˜Ÿï¼‰ã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">- åŒå‘é˜Ÿåˆ—ï¼šæ„å‘³ç€å…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶ä»é˜Ÿåˆ—çš„ä¸¤ç«¯è¿›è¡Œæ’å…¥ã€åˆ é™¤å’ŒæŸ¥æ‰¾æ“ä½œï¼ˆéå…¬å¹³é”æ’é˜Ÿï¼‰ã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">é˜Ÿåˆ—é‡Œæ”¾ç­‰å¾…çš„çº¿ç¨‹
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="C:%5cUsers%5cwzt%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250108192703362.png"
	
	
	
	loading="lazy"
	
		alt="image-20250108192703362"
	
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">è¯·æ±‚è·å–é”-&gt;å…¥é˜Ÿ
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">å¤šçº¿ç¨‹å¹¶å‘æ‰§è¡Œä»»åŠ¡ï¼ŒåŠ é”
</span></span><span class="line"><span class="cl">æ€ä¹ˆåŠ ï¼š
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">çº¿ç¨‹å»æŠ¢AQSç±»é‡Œstateå±æ€§(èµ„æº)ï¼Œåˆå§‹ä¸º0è¡¨ç¤ºé”æ²¡äººç”¨ï¼ŒæŠ¢åˆ°äº†å0å˜ä¸º1.å˜ä¸º1åå…¶ä»–çº¿ç¨‹å°±ä¸èƒ½æŠ¢ï¼Œå¾—åœ¨é˜Ÿåˆ—é‡Œæ’é˜Ÿï¼Œç›´åˆ°stateå˜ä¸º0(çº¿ç¨‹ä»»åŠ¡æ‰§è¡Œå®Œäº† ä¹Ÿå°±æ˜¯é‡Šæ”¾é”)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">å…¬å¹³é”ï¼šæ’é˜Ÿä½¿ç”¨ å…¬å¹³é”æŒ‡çš„æ˜¯æŒ‰ç…§çº¿ç¨‹è¯·æ±‚çš„é¡ºåºï¼Œæ¥åˆ†é…é”
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">éå…¬å¹³é”ï¼š ä¸€å®šæƒ…å†µä¸‹ï¼Œå¯ä»¥å…è®¸æ’é˜Ÿ
</span></span><span class="line"><span class="cl">å½“å‰çº¿ç¨‹åœ¨è¯·æ±‚è·å–é”çš„æ—¶å€™ï¼Œæ°å·§å‰ä¸€ä¸ªæŒæœ‰é”çš„çº¿ç¨‹é‡Šæ”¾äº†è¿™æŠŠé”ï¼Œé‚£ä¹ˆå½“å‰ç”³è¯·é”çš„çº¿ç¨‹å°±å¯ä»¥ä¸é¡¾å·²ç»ç­‰å¾…çš„çº¿ç¨‹è€Œé€‰æ‹©ç«‹åˆ»æ’é˜Ÿã€‚
</span></span><span class="line"><span class="cl">ä½†æ˜¯å¦‚æœå½“å‰çº¿ç¨‹è¯·æ±‚çš„æ—¶å€™ï¼Œå‰ä¸€ä¸ªçº¿ç¨‹å¹¶æ²¡æœ‰åœ¨é‚£ä¸€æ—¶åˆ»é‡Šæ”¾é”ï¼Œé‚£ä¹ˆå½“å‰çº¿ç¨‹è¿˜æ˜¯ä¸€æ ·ä¼šè¿›å…¥ç­‰å¾…é˜Ÿåˆ—ã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>state å±æ€§</strong>ï¼šè¡¨ç¤ºèµ„æºçš„çŠ¶æ€</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">- å¯¹äºReentrantLockæ¥è¯´ï¼Œstate=1ï¼Œè¡¨ç¤ºèµ„æºè¢«å ç”¨ï¼›state=0ï¼Œè¡¨ç¤ºèµ„æºæ²¡æœ‰è¢«å ç”¨ã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">- å¯¹äºCountDownLatchæ¥è¯´ï¼Œstate=0ï¼Œè¡¨ç¤ºè®¡æ•°å™¨å½’é›¶ï¼Œæ‰€æœ‰çº¿ç¨‹éƒ½å¯ä»¥è®¿é—®èµ„æºï¼›stateä¸ºNè¡¨ç¤ºè®¡æ•°å™¨æœªå½’é›¶ï¼Œæ‰€æœ‰çº¿ç¨‹éƒ½éœ€è¦é˜»å¡ã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="reentrantlock">ReentrantLock
</h2><p>é»˜è®¤éå…¬å¹³é”</p>
<p><img src="C:%5cUsers%5cwzt%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20250108194314586.png"
	
	
	
	loading="lazy"
	
		alt="image-20250108194314586"
	
	
></p>
<p>åœ¨ReentrantLockç±»ä¸­åŒ…å«äº†3ä¸ªAQSçš„å®ç°ç±»ï¼š</p>
<ol>
<li>æŠ½è±¡ç±»Sync</li>
<li>éå…¬å¹³é”å®ç°ç±»NonfaireSync</li>
<li>å…¬å¹³é”å®ç°ç±»FairSync</li>
</ol>
<h3 id="ä¸Šé”è°ƒè¯•å…¬å¹³é”è§£é”">ä¸Šé”ï¼Œè°ƒè¯•å…¬å¹³é”ï¼Œè§£é”
</h3><p>è¯¦æƒ…çœ‹ç¬”è®°</p>
<h3 id="aqsçš„åº•å±‚åŸç†">AQSçš„åº•å±‚åŸç†
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">AQSä½¿ç”¨ä¸€ä¸ªvolatileæˆå‘˜å˜é‡stateæ¥è¡¨ç¤ºé”æ˜¯å¦å·²è¢«æŒæœ‰ï¼Œé€šè¿‡å†…ç½®çš„FIFOé˜Ÿåˆ—å­˜å‚¨è¢«é˜»å¡çš„çº¿ç¨‹ã€‚
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">AQSä½¿ç”¨CASæœºåˆ¶å¯¹stateè¿›è¡ŒåŸå­æ“ä½œä»è€Œå¯¹stateçš„å€¼è¿›è¡Œä¿®æ”¹ã€‚
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">å¦‚æœstateçš„å€¼ä¸º0ï¼Œè¡¨ç¤ºé”æœªè¢«æŒæœ‰ï¼Œåˆ™å°†å½“å‰çº¿ç¨‹è®¾ç½®ä¸ºå·¥ä½œçº¿ç¨‹ï¼ˆå³è·å–åˆ°äº†é”ï¼‰ï¼Œå¹¶å°†stateçš„å€¼è®¾ç½®ä¸º1ï¼Œè¿”å›æˆåŠŸè·å–åˆ°é”ã€‚
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">å¦‚æœæœªèƒ½æˆåŠŸè·å–åˆ°é”ï¼ŒAQSå…ˆè‡ªæ—‹è·å–é”ï¼Œå¦‚æœä¸€ç›´è·å–ä¸åˆ°ï¼Œåˆ™å°†å½“å‰è·å–ä¸åˆ°é”çš„çº¿ç¨‹åŠ å…¥åˆ°FIFOé˜Ÿåˆ—ä¸­
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">æ„æˆï¼š
</span></span><span class="line"><span class="cl">AQSä½¿ç”¨ä¸€ä¸ªvolatileæˆå‘˜å˜é‡stateæ¥è¡¨ç¤ºé”æ˜¯å¦å·²è¢«æŒæœ‰(0/1)ï¼Œé€šè¿‡å†…ç½®çš„FIFOé˜Ÿåˆ—å­˜å‚¨è¢«é˜»å¡çš„çº¿ç¨‹
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">æ€ä¹ˆæ”¹stateï¼š
</span></span><span class="line"><span class="cl">AQSä½¿ç”¨CASæœºåˆ¶å¯¹stateè¿›è¡ŒåŸå­æ“ä½œä»è€Œå¯¹stateçš„å€¼è¿›è¡Œä¿®æ”¹
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">æ€ä¹ˆå–åˆ°é”:
</span></span><span class="line"><span class="cl">å¦‚æœstateçš„å€¼ä¸º0ï¼Œè¡¨ç¤ºé”æœªè¢«æŒæœ‰ï¼Œåˆ™å°†å½“å‰çº¿ç¨‹è®¾ç½®ä¸ºå·¥ä½œçº¿ç¨‹ï¼ˆå³è·å–åˆ°äº†é”ï¼‰ï¼Œå¹¶å°†stateçš„å€¼è®¾ç½®ä¸º1ï¼Œè¿”å›æˆåŠŸè·å–åˆ°é”ã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">å–ä¸åˆ°æ€ä¹ˆåŠï¼š
</span></span><span class="line"><span class="cl">å¦‚æœæœªèƒ½æˆåŠŸè·å–åˆ°é”ï¼ŒAQSå…ˆè‡ªæ—‹è·å–é”
</span></span><span class="line"><span class="cl">å¦‚æœä¸€ç›´è·å–ä¸åˆ°ï¼Œåˆ™å°†å½“å‰è·å–ä¸åˆ°é”çš„çº¿ç¨‹åŠ å…¥åˆ°FIFOé˜Ÿåˆ—ä¸­
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>æ³¨ï¼šFIFOå…¬å¹³é”  åŒå‘é˜Ÿåˆ—ï¼šéå…¬å¹³é”</strong></p>
<h2 id="è‡ªæ—‹é”">è‡ªæ—‹é”
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">æ˜¯æŒ‡å½“ä¸€ä¸ªçº¿ç¨‹åœ¨è·å–é”çš„æ—¶å€™ï¼Œå¦‚æœé”å·²ç»è¢«å…¶å®ƒçº¿ç¨‹è·å–ï¼Œé‚£ä¹ˆè¯¥çº¿ç¨‹å°†å¾ªç¯ç­‰å¾…ï¼Œç„¶åä¸æ–­çš„åˆ¤æ–­é”æ˜¯å¦èƒ½å¤Ÿè¢«æˆåŠŸè·å–ï¼Œç›´åˆ°è·å–åˆ°é”æ‰ä¼šé€€å‡ºå¾ªç¯ã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">è¿™æ ·è·å–é”çš„çº¿ç¨‹ä¸€ç›´å¤„äºæ´»è·ƒçŠ¶æ€
</span></span><span class="line"><span class="cl">ä½†æ˜¯å¹¶æ²¡æœ‰æ‰§è¡Œä»»ä½•æœ‰æ•ˆçš„ä»»åŠ¡
</span></span><span class="line"><span class="cl">é•¿æ—¶é—´ä½¿ç”¨è¿™ç§é”ä¼šé€ æˆç³»ç»Ÿè´Ÿè½½å¾ˆå¤§ï¼Œè€—è´¹æ€§èƒ½ï¼Œé˜»æ­¢äº†å…¶ä»–çº¿ç¨‹çš„è¿è¡Œå’Œè°ƒåº¦
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">è‡ªæ—‹çš„çº¿ç¨‹ä¿æŒæ—‹è½¬çŠ¶æ€(åå¤å°è¯•è·å–é”)ï¼Œè€ŒæŒæœ‰è¯¥é”çš„çº¿ç¨‹å¹¶ä¸æ‰“ç®—é‡Šæ”¾é”ï¼Œè¿™æ ·å¯¼è‡´çš„æ˜¯ç»“æœæ˜¯æ— é™æœŸæ¨è¿Ÿï¼Œç›´åˆ°æŒæœ‰é”çš„çº¿ç¨‹å¯ä»¥å®Œæˆå¹¶é‡Šæ”¾å®ƒä¸ºæ­¢ã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>å¯¹äºReentrantLockæ¥è¯´ï¼Œè‡ªæ—‹çš„è¿‡ç¨‹å°±æ˜¯ä¸æ–­å°è¯• è°ƒç”¨lock()çš„è¿‡ç¨‹ï¼ˆä½¿ç”¨CASçš„æ–¹å¼ä¿®æ”¹stateå€¼ï¼‰</li>
<li>å¯¹äºåŸå­æ“ä½œç±»æ¥è¯´ï¼Œè‡ªæ—‹çš„è¿‡ç¨‹å°±æ˜¯æ¯”è¾ƒå’Œäº¤æ¢å¤±è´¥åå†æ¬¡å°è¯•æ¯”è¾ƒå’Œäº¤æ¢çš„è¿‡ç¨‹ï¼ˆCASï¼‰</li>
</ul>
<h3 id="è‡ªæ—‹é”ä¼˜ç‚¹">è‡ªæ—‹é”ä¼˜ç‚¹
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">1.è‡ªæ—‹é”å°½å¯èƒ½çš„å‡å°‘çº¿ç¨‹çš„é˜»å¡
</span></span><span class="line"><span class="cl">è¿™å¯¹äºé”çš„ç«äº‰ä¸æ¿€çƒˆï¼Œä¸”å ç”¨é”æ—¶é—´éå¸¸çŸ­çš„ä»£ç å— æ¥è¯´æ€§èƒ½èƒ½å¤§å¹…åº¦çš„æå‡
</span></span><span class="line"><span class="cl">å› ä¸ºè‡ªæ—‹çš„æ¶ˆè€—ä¼šå°äºçº¿ç¨‹é˜»å¡æŒ‚èµ·å†å”¤é†’çš„æ“ä½œçš„æ¶ˆè€—
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">2.ä¸ä½¿ç”¨è‡ªæ—‹ï¼Œå¹¶ä¸”è·å–ä¸åˆ°é”çš„æ—¶å€™ç›´æ¥è¿›å…¥é˜»å¡çŠ¶æ€
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="è‡ªæ—‹é”ç¼ºç‚¹">è‡ªæ—‹é”ç¼ºç‚¹
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">å¦‚æœé”çš„ç«äº‰æ¿€çƒˆï¼Œæˆ–è€…æŒæœ‰é”çš„çº¿ç¨‹éœ€è¦é•¿æ—¶é—´å ç”¨é”æ‰§è¡ŒåŒæ­¥å—
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">è¿™ç§æƒ…å†µä¸é€‚åˆä½¿ç”¨è‡ªæ—‹é”
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">å› ä¸ºè‡ªæ—‹é”åœ¨è·å–é”å‰ä¸€ç›´éƒ½æ˜¯å ç”¨ cpu åšæ— ç”¨åŠŸï¼Œçº¿ç¨‹è‡ªæ—‹çš„æ¶ˆè€—å¤§äºçº¿ç¨‹é˜»å¡æŒ‚èµ·æ“ä½œçš„æ¶ˆè€—ï¼Œå…¶å®ƒéœ€è¦ cpu çš„çº¿ç¨‹åˆä¸èƒ½è·å–åˆ° cpuï¼Œé€ æˆ cpu çš„æµªè´¹ã€‚
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">æ‰€ä»¥è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬è¦å…³é—­è‡ªæ—‹é”ã€‚
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="synchronizedé”å‡çº§è¿‡ç¨‹">synchronizedé”å‡çº§è¿‡ç¨‹
</h1><ul>
<li>
<p>æ— é”çŠ¶æ€ï¼šæ²¡æœ‰çº¿ç¨‹æ¥ç”³è¯·é”</p>
</li>
<li>
<p>åå‘é”çŠ¶æ€ï¼šåªæœ‰ä¸€ä¸ªçº¿ç¨‹æ¥ç”³è¯·é”ï¼Œã€æ²¡æœ‰ç«äº‰ã€‘ï¼Œä¸éœ€è¦åšåŠ é”ã€è§£é”çš„æ“ä½œ</p>
<ul>
<li>ä»æ— é”çŠ¶æ€åˆ°å½“å‰çŠ¶æ€ï¼Œæ¯æ¬¡æ¥ç”³è¯·é”çš„éƒ½æ˜¯è¿™åŒä¸€ä¸ªçº¿ç¨‹ï¼Œä¸­é—´æ²¡æœ‰åˆ«çš„çº¿ç¨‹æ¥ç”³è¯·è¿‡</li>
</ul>
</li>
<li>
<p>è½»é‡çº§é”çŠ¶æ€ï¼šåªæœ‰ä¸€ä¸ªçº¿ç¨‹æ¥ç”³è¯·é”ï¼Œã€æ²¡æœ‰ç«äº‰ã€‘ï¼Œä¸éœ€è¦åšåŠ é”ã€è§£é”çš„æ“ä½œ</p>
<ul>
<li>ä»ä¸Šä¸€ä¸ªçŠ¶æ€åˆ°ç°åœ¨çŠ¶æ€ï¼Œé”å¯¹è±¡è¢«ä¸åŒçº¿ç¨‹ç”³è¯·è¿‡ï¼Œåªä¸è¿‡æ¯æ¬¡éƒ½æ˜¯åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ¥ç”³è¯·</li>
</ul>
</li>
<li>
<p>é‡é‡çº§é”çŠ¶æ€ï¼šåŒæ—¶æœ‰å¤šä¸ªçº¿ç¨‹æ¥ç”³è¯·é”ï¼Œã€æœ‰ç«äº‰ã€‘ï¼Œéœ€è¦åšåŠ é”ã€è§£é”çš„æ“ä½œ</p>
</li>
</ul>

</section>


    <footer class="article-footer">
    

    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">ç›¸å…³æ–‡ç« </h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/yuan/p/juc/">
        
        

        <div class="article-details">
            <h2 class="article-title">juc</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/yuan/p/%E7%BA%BF%E7%A8%8B%E6%B1%A0/">
        
        

        <div class="article-details">
            <h2 class="article-title">çº¿ç¨‹æ± </h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/yuan/p/jvm/">
        
        

        <div class="article-details">
            <h2 class="article-title">JVM</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/yuan/p/javaweb%E5%92%8Cssm%E9%A2%98%E5%BA%93/">
        
        

        <div class="article-details">
            <h2 class="article-title">JavaWEBå’ŒSSMé¢˜åº“</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/yuan/p/%E9%94%81%E7%9B%B8%E5%85%B3/">
        
        

        <div class="article-details">
            <h2 class="article-title">é”ç›¸å…³</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "hugo-theme-stack" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (typeof DISQUS == 'object') {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2024 - 
        
        2025 ç±³é¥­èƒ½åƒé¥±
    </section>
    
    <section class="powerby">
        ä½¿ç”¨ <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> æ„å»º <br />
        ä¸»é¢˜ <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.29.0">Stack</a></b> ç”± <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> è®¾è®¡
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/yuan/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
